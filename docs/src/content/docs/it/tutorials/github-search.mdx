---
title: GitHub Search
description:
  Guida completa alla creazione di un'app GitHub Search in Flutter e AngularDart
  con bloc.
sidebar:
  order: 9
---

import RemoteCode from '~/components/code/RemoteCode.astro';
import SetupSnippet from '~/components/tutorials/github-search/SetupSnippet.astro';
import DartPubGetSnippet from '~/components/tutorials/github-search/DartPubGetSnippet.astro';
import FlutterCreateSnippet from '~/components/tutorials/github-search/FlutterCreateSnippet.astro';
import FlutterPubGetSnippet from '~/components/tutorials/FlutterPubGetSnippet.astro';
import StagehandSnippet from '~/components/tutorials/github-search/StagehandSnippet.astro';
import ActivateStagehandSnippet from '~/components/tutorials/github-search/ActivateStagehandSnippet.astro';

![advanced](https://img.shields.io/badge/level-advanced-red.svg)

In questo tutorial costruiremo un'app GitHub Search in Flutter e AngularDart per
dimostrare come condividere i livelli dati e la logica applicativa tra i due
progetti.

![demo](~/assets/tutorials/flutter-github-search.gif)

![demo](~/assets/tutorials/ngdart-github-search.gif)

## Argomenti Chiave

- [BlocProvider](/it/flutter-bloc-concepts#blocprovider), widget Flutter che
  fornisce un'istanza di bloc ai suoi figli;
- [BlocBuilder](/it/flutter-bloc-concepts#blocbuilder), widget Flutter che
  gestisce la costruzione del widget in risposta a nuovi stati;
- Usare Cubit invece di Bloc.
  [Qual è la differenza?](/it/bloc-concepts#cubit-vs-bloc);
- Prevenire aggiornamenti non necessari con
  [Equatable](/it/faqs#when-to-use-equatable);
- Usare un `EventTransformer` personalizzato con
  [`bloc_concurrency`](https://pub.dev/packages/bloc_concurrency);
- Eseguire richieste di rete usando il pacchetto `http`.

## Libreria Condivisa GitHub Search

La libreria "Common GitHub Search" conterrà i modelli, il data provider, il
repository e il bloc che saranno condivisi tra AngularDart e Flutter.

### Configurazione

Inizieremo creando una nuova directory per l'applicazione.

<SetupSnippet />

:::note

La directory `common_github_search` conterrà la libreria condivisa.

:::

Dobbiamo creare un `pubspec.yaml` con le dipendenze richieste.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/pubspec.yaml"
	title="common_github_search/pubspec.yaml"
/>

Infine, installiamo le dipendenze.

<DartPubGetSnippet />

Questo è tutto per il setup del progetto! Ora possiamo iniziare a lavorare sulla
costruzione del pacchetto `common_github_search`.

### Github Client

Il `GithubClient` fornirà i dati grezzi
dall'[API GitHub](https://developer.github.com/v3/).

:::note

Puoi vedere un esempio dei dati che otterremo
[qui](https://api.github.com/search/repositories?q=dartlang).

:::

Creiamo `github_client.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/github_client.dart"
	title="common_github_search/lib/src/github_client.dart"
/>

:::note

Il nostro `GithubClient` esegue semplicemente una richiesta di rete all'API
Repository Search di Github e converte il risultato in un `SearchResult` o
`SearchResultError` come `Future`.

:::

:::note

L'implementazione di `GithubClient` dipende da `SearchResult.fromJson`, che non
abbiamo ancora implementato.

:::

Successivamente dobbiamo definire i nostri modelli `SearchResult` e
`SearchResultError`.

#### Modello Search Result

Crea `search_result.dart`, che rappresenta una lista di `SearchResultItems`
basata sulla query dell'utente:

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/models/search_result.dart"
	title="lib/src/models/search_result.dart"
/>

:::note

L'implementazione di `SearchResult` dipende da `SearchResultItem.fromJson`, che
non abbiamo ancora implementato.

:::

:::note

Non includiamo proprietà che non verranno utilizzate nel nostro modello.

:::

#### Modello Search Result Item

Successivamente, creeremo `search_result_item.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/models/search_result_item.dart"
	title="lib/src/models/search_result_item.dart"
/>

:::note

Anche qui, l'implementazione di `SearchResultItem` dipende da
`GithubUser.fromJson`, che non abbiamo ancora implementato.

:::

#### Modello GitHub User

Creiamo `github_user.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/models/github_user.dart"
	title="lib/src/models/github_user.dart"
/>

A questo punto abbiamo finito di implementare `SearchResult` e le sue
dipendenze. Ora passeremo a `SearchResultError`.

#### Modello Search Result Error

Crea `search_result_error.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/models/search_result_error.dart"
	title="lib/src/models/search_result_error.dart"
/>

Il nostro `GithubClient` è finito. Passeremo ora al `GithubCache`, che sarà
responsabile della [memoizzazione](https://it.wikipedia.org/wiki/Memoizzazione)
per ottimizzare le prestazioni.

### GitHub Cache

Il nostro `GithubCache` sarà responsabile di ricordare tutte le query passate,
evitando così di fare richieste di rete non necessarie all'API GitHub. Questo
aiuterà anche a migliorare le prestazioni della nostra applicazione.

Crea `github_cache.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/github_cache.dart"
	title="lib/src/github_cache.dart"
/>

Ora siamo pronti a creare il nostro `GithubRepository`!

### GitHub Repository

Il Github Repository ha il compito di creare un'astrazione tra il livello dati
(`GithubClient`) e il livello di logica applicativa (`Bloc`). È qui che
utilizzeremo il nostro `GithubCache`.

Crea `github_repository.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/github_repository.dart"
	title="lib/src/github_repository.dart"
/>

:::note

Il `GithubRepository` ha una dipendenza da `GithubCache` e `GithubClient` e
astrae l'implementazione sottostante. La nostra applicazione non deve mai sapere
come i dati vengono recuperati o da dove provengono. Possiamo cambiare il
funzionamento del repository in qualsiasi momento e, finché non cambiamo
l'interfaccia, non dovremo modificare alcun codice client.

:::

A questo punto abbiamo completato il livello data provider e il livello
repository; siamo pronti a passare al livello di logica applicativa.

### GitHub Search Event

Il nostro Bloc sarà notificato quando un utente digita il nome di un repository;
rappresenteremo questa azione come un `GithubSearchEvent` di tipo `TextChanged`.

Crea `github_search_event.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/github_search_bloc/github_search_event.dart"
	title="lib/src/github_search_bloc/github_search_event.dart"
/>

:::note

Estendiamo [`Equatable`](https://pub.dev/packages/equatable) per poter
confrontare per valore istanze di `GithubSearchEvent`. Di default, l'operatore
di uguaglianza restituisce true se e solo se le istanze puntano allo stesso
riferimento in memoria.

:::

### Github Search State

Il nostro livello di presentazione necessita di diverse informazioni per
renderizzarsi correttamente:

- `SearchStateEmpty`: indica al livello di presentazione che l'utente non ha
  fornito input;
- `SearchStateLoading`: indica al livello di presentazione di visualizzare un
  indicatore di caricamento;
- `SearchStateSuccess`: indica che ci sono dati da presentare.
  - `items`: la `List<SearchResultItem>` che sarà visualizzata;
- `SearchStateError`: indica che si è verificato un errore durante il recupero
  dei repository.
  - `error`: l'errore esatto che si è verificato.

Possiamo ora creare `github_search_state.dart` e implementarlo così:

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/github_search_bloc/github_search_state.dart"
	title="lib/src/github_search_bloc/github_search_state.dart"
/>

:::note

Estendiamo [`Equatable`](https://pub.dev/packages/equatable) per poter
confrontare istanze di `GithubSearchState` per valore e non per riferimento.

:::

Ora che abbiamo implementato i nostri Eventi e Stati, possiamo creare il nostro
`GithubSearchBloc`.

### GitHub Search Bloc

Crea `github_search_bloc.dart`:

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/common_github_search/lib/src/github_search_bloc/github_search_bloc.dart"
	title="lib/src/github_search_bloc/github_search_bloc.dart"
/>

:::note

Il nostro `GithubSearchBloc` converte `GithubSearchEvent` in `GithubSearchState`
e ha una dipendenza da `GithubRepository`.

:::

:::note

Creiamo un `EventTransformer` personalizzato per il
["debounce"](https://pub.dev/documentation/stream_transform/latest/stream_transform/RateLimit/debounce.html)
dei `GithubSearchEvent`. Una delle ragioni per cui abbiamo creato un `Bloc`
invece di un `Cubit` è proprio per sfruttare i trasformatori di stream.

:::

Fantastico! Abbiamo finito con il nostro pacchetto `common_github_search`. Il
prodotto finito dovrebbe essere simile a
[questo](https://github.com/felangel/bloc/tree/master/examples/github_search/common_github_search).

Successivamente, lavoreremo sull'implementazione Flutter.

## Flutter GitHub Search

Flutter Github Search sarà un'applicazione Flutter che riutilizza modelli, data
provider, repository e bloc da `common_github_search` per implementare la
ricerca GitHub.

### Configurazione

Iniziamo creando un nuovo progetto Flutter nella nostra directory
`github_search` allo stesso livello di `common_github_search`.

<FlutterCreateSnippet />

Dobbiamo aggiornare il nostro `pubspec.yaml` per includere tutte le dipendenze
necessarie.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/flutter_github_search/pubspec.yaml"
	title="flutter_github_search/pubspec.yaml"
/>

:::note

Stiamo includendo la nostra libreria `common_github_search` appena creata come
dipendenza.

:::

Ora installiamo le dipendenze.

<FlutterPubGetSnippet />

Questo è tutto per il setup del progetto. Poiché il pacchetto
`common_github_search` contiene il nostro livello dati e la logica applicativa,
tutto ciò che dobbiamo costruire è il livello di presentazione.

### Search Form

Dovremo creare un form con i widget `_SearchBar` e `_SearchBody`.

- `_SearchBar` sarà responsabile della gestione dell'input utente;
- `_SearchBody` sarà responsabile della visualizzazione dei risultati di
  ricerca, indicatori di caricamento ed errori.

Creiamo `search_form.dart`. Il nostro `SearchForm` sarà un `StatelessWidget` che
renderizza i widget `_SearchBar` e `_SearchBody`.

`_SearchBar` sarà uno `StatefulWidget` perché dovrà mantenere il proprio
`TextEditingController` per tracciare l'input dell'utente.

`_SearchBody` è un `StatelessWidget` responsabile di mostrare risultati, errori
e caricamenti. Sarà il consumatore del `GithubSearchBloc`.

Se il nostro stato è `SearchStateSuccess`, renderizziamo `_SearchResults` (che
implementeremo successivamente). `_SearchResults` è un `StatelessWidget` che
prende una `List<SearchResultItem>` e la visualizza come lista di
`_SearchResultItem`.

`_SearchResultItem` è un `StatelessWidget` responsabile del rendering delle
informazioni per un singolo risultato. Gestisce anche l'interazione dell'utente,
navigando all'url del repository al tocco.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/flutter_github_search/lib/search_form.dart"
	title="flutter_github_search/lib/search_form.dart"
/>

:::note

`_SearchBar` accede a `GitHubSearchBloc` tramite
`context.read<GithubSearchBloc>()` e notifica il bloc degli eventi
`TextChanged`.

:::

:::note

`_SearchBody` usa `BlocBuilder` per ricostruire la UI in risposta ai cambiamenti
di stato. Poiché il parametro bloc dell'oggetto `BlocBuilder` è stato omesso,
`BlocBuilder` eseguirà automaticamente un lookup usando `BlocProvider` e il
`BuildContext` corrente. Leggi di più
[qui](/it/flutter-bloc-concepts#blocbuilder).

:::

:::note

Usiamo `ListView.builder` per costruire una lista scrollabile di
`_SearchResultItem`.

:::

:::note

Usiamo il pacchetto [url_launcher](https://pub.dev/packages/url_launcher) per
aprire url esterni.

:::

### Riassumendo

Ora tutto ciò che resta da fare è implementare la nostra app principale in
`main.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/flutter_github_search/lib/main.dart"
	title="flutter_github_search/lib/main.dart"
/>

:::note

Il nostro `GithubRepository` è creato in `main` e iniettato nel nostro `App`. Il
nostro `SearchForm` è avvolto in un `BlocProvider` che è responsabile di
inizializzare, chiudere e rendere disponibile l'istanza di `GithubSearchBloc` al
widget `SearchForm` e ai suoi figli.

:::

Questo è tutto! Abbiamo implementato con successo un'app di ricerca GitHub in
Flutter usando i pacchetti [bloc](https://pub.dev/packages/bloc) e
[flutter_bloc](https://pub.dev/packages/flutter_bloc), separando il livello di
presentazione dalla logica applicativa.

Il codice sorgente completo può essere trovato
[qui](https://github.com/felangel/bloc/tree/master/examples/github_search/flutter_github_search).

Infine, costruiremo la nostra app AngularDart GitHub Search.

## AngularDart GitHub Search

AngularDart GitHub Search sarà un'applicazione AngularDart che riutilizza i
modelli, data provider, repository e bloc da `common_github_search` per
implementare Github Search.

### Configurazione

Dobbiamo iniziare creando un nuovo progetto AngularDart nella nostra directory
github_search, allo stesso livello di `common_github_search`.

<StagehandSnippet />

:::note

Puoi installare `stagehand` tramite:

<ActivateStagehandSnippet />

:::

Possiamo poi sostituire il contenuto di `pubspec.yaml` con:

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/pubspec.yaml"
	title="angular_github_search/pubspec.yaml"
/>

### Search Form

Proprio come nella nostra app Flutter, dovremo creare un `SearchForm` con un
componente `SearchBar` e `SearchBody`.

Il nostro componente `SearchForm` implementerà `OnInit` e `OnDestroy` perché
dovrà creare e chiudere un `GithubSearchBloc`.

- `SearchBar` sarà responsabile della gestione dell'input utente;
- `SearchBody` sarà responsabile della visualizzazione dei risultati di ricerca,
  indicatori di caricamento ed errori.

Creiamo `search_form_component.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_form_component.dart"
	title="angular_github_search/lib/src/search_form/search_form_component.dart"
/>

:::note

Il `GithubRepository` è iniettato nel `SearchFormComponent`.

:::

:::note

Il `GithubSearchBloc` è creato e chiuso dal `SearchFormComponent`.

:::

Il nostro template (`search_form_component.html`) sarà:

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_form_component.html"
	title="angular_github_search/lib/src/search_form/search_form_component.html"
/>

Successivamente, implementeremo il componente `SearchBar`.

### Search Bar

`SearchBar` è un componente responsabile di prendere l'input dell'utente e
notificare il `GithubSearchBloc` dei cambiamenti di testo.

Crea `search_bar_component.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_bar/search_bar_component.dart"
	title="angular_github_search/lib/src/search_form/search_bar/search_bar_component.dart"
/>

:::note

`SearchBarComponent` ha una dipendenza su `GitHubSearchBloc` perché è
responsabile di notificare il bloc degli eventi `TextChanged`.

:::

Successivamente, possiamo creare `search_bar_component.html`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_bar/search_bar_component.html"
	title="angular_github_search/lib/src/search_form/search_bar/search_bar_component.html"
/>

Abbiamo finito con `SearchBar`, ora passiamo a `SearchBody`.

### Search Body

`SearchBody` è il componente responsabile della visualizzazione di risultati,
errori e indicatori di caricamento. Sarà il consumatore del `GithubSearchBloc`.

Crea `search_body_component.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_body/search_body_component.dart"
	title="angular_github_search/lib/src/search_form/search_body/search_body_component.dart"
/>

:::note

`SearchBodyComponent` ha una dipendenza su `GithubSearchState` che viene fornito
dal `GithubSearchBloc` usando la bloc pipe di `angular_bloc`.

:::

Crea `search_body_component.html`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_body/search_body_component.html"
	title="angular_github_search/lib/src/search_form/search_body/search_body_component.html"
/>

Se il nostro stato `isSuccess`, renderizziamo `SearchResults`. Lo implementeremo
ora.

### Search Results

`SearchResults` è un componente che prende una `List<SearchResultItem>` e la
visualizza come una lista di `SearchResultItem`.

Crea `search_results_component.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_body/search_results/search_results_component.dart"
	title="angular_github_search/lib/src/search_form/search_body/search_results/search_results_component.dart"
/>

Successivamente creeremo `search_results_component.html`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_body/search_results/search_results_component.html"
	title="angular_github_search/lib/src/search_form/search_body/search_results/search_results_component.html"
/>

:::note

Usiamo `ngFor` per costruire una lista di componenti `SearchResultItem`.

:::

È ora di implementare `SearchResultItem`.

### Search Result Item

`SearchResultItem` è un componente responsabile del rendering delle informazioni
per un singolo risultato di ricerca. Gestisce anche l'interazione dell'utente e
la navigazione all'URL del repository.

Crea `search_result_item_component.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_body/search_results/search_result_item/search_result_item_component.dart"
	title="angular_github_search/lib/src/search_form/search_body/search_results/search_result_item/search_result_item_component.dart"
/>

e il template corrispondente in `search_result_item_component.html`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/src/search_form/search_body/search_results/search_result_item/search_result_item_component.html"
	title="angular_github_search/lib/src/search_form/search_body/search_results/search_result_item/search_result_item_component.html"
/>

### Riassumendo

Abbiamo tutti i nostri componenti ed è il momento di assemblarli nel nostro
`app_component.dart`.

<RemoteCode
	url="https://raw.githubusercontent.com/felangel/bloc/master/examples/github_search/angular_github_search/lib/app_component.dart"
	title="angular_github_search/lib/app_component.dart"
/>

:::note

Stiamo creando il `GithubRepository` nell'`AppComponent` e lo iniettiamo nel
componente `SearchForm`.

:::

Questo è tutto! Abbiamo implementato con successo un'app di ricerca GitHub in
AngularDart usando i pacchetti `bloc` e `angular_bloc`, separando il livello di
presentazione dalla logica applicativa.

Il codice sorgente completo può essere trovato
[qui](https://github.com/felangel/bloc/tree/master/examples/github_search/angular_github_search).

## Riepilogo

In questo tutorial abbiamo creato un'app Flutter e una AngularDart condividendo
tutti i modelli, data provider e bloc tra le due. L'unica cosa che abbiamo
dovuto scrivere due volte è stato il livello di presentazione (UI), il che è
fantastico in termini di efficienza e velocità di sviluppo.

Inoltre, è piuttosto comune che app web e mobile abbiano esperienze utente e
stili diversi; questo approccio dimostra quanto sia facile costruire due app che
appaiono totalmente diverse ma condividono gli stessi livelli di dati e logica
applicativa.

Il codice sorgente completo può essere trovato
[qui](https://github.com/felangel/bloc/tree/master/examples/github_search).
