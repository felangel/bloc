---
title: مدل‌سازی حالت
description: نمای کلی از چندین روش برای مدل‌سازی حالت‌ها هنگام استفاده از package:bloc.
---

import ConcreteClassAndStatusEnumSnippet from '~/components/modeling-state/ConcreteClassAndStatusEnumSnippet.astro';
import SealedClassAndSubclassesSnippet from '~/components/modeling-state/SealedClassAndSubclassesSnippet.astro';

روش‌های مختلفی برای ساختاردهی به حالت برنامه وجود دارد. هر کدام مزایا و معایب خود را دارد. در این بخش، به چندین رویکرد نگاه خواهیم کرد، مزایا و معایب آنها، و زمان استفاده از هر کدام.

رویکردهای زیر صرفاً توصیه هستند و کاملاً اختیاری. آزادانه از هر رویکردی که ترجیح می‌دهید استفاده کنید. ممکن است برخی از مثال‌ها/مستندات از رویکردها پیروی نکنند، عمدتاً برای سادگی/کوتاهی.

:::tip

قطعه کدهای زیر بر ساختار حالت تمرکز دارند. در عمل، ممکن است بخواهید:

- از `Equatable` ارث‌بری کنید از [`package:equatable`](https://pub.dev/packages/equatable)
- کلاس را با `@Data()` از [`package:data_class`](https://pub.dev/packages/data_class) حاشیه‌نویسی کنید
- کلاس را با **@immutable** از [`package:meta`](https://pub.dev/packages/meta) حاشیه‌نویسی کنید
- یک متد `copyWith` پیاده‌سازی کنید
- از کلمه کلیدی `const` برای سازنده‌ها استفاده کنید

:::

## کلاس پایه و Enum وضعیت

این رویکرد از یک **کلاس پایه واحد** برای همه حالت‌ها به همراه یک `enum` که وضعیت‌های مختلف را نشان می‌دهد تشکیل شده است. ویژگی‌ها nullable هستند و بر اساس وضعیت فعلی مدیریت می‌شوند. این رویکرد برای حالت‌هایی که کاملاً انحصاری نیستند و/یا دارای ویژگی‌های مشترک زیادی هستند بهترین کار را می‌کند.

<ConcreteClassAndStatusEnumSnippet />

#### مزایا

- **ساده**: مدیریت یک کلاس و یک enum وضعیت آسان است و همه ویژگی‌ها به راحتی قابل دسترسی هستند.
- **کوتاه**: به طور کلی نیاز به خطوط کد کمتری نسبت به رویکردهای دیگر دارد.

#### معایب

- **ایمن از نظر نوع نیست**: نیاز به بررسی `status` قبل از دسترسی به ویژگی‌ها دارد. امکان `emit` کردن یک حالت نادرست وجود دارد که می‌تواند منجر به باگ شود. ویژگی‌ها برای حالت‌های خاص nullable هستند، که مدیریت آنها می‌تواند دشوار باشد و نیاز به باز کردن اجباری یا انجام بررسی‌های null دارد. برخی از این معایب می‌توانند با نوشتن تست‌های واحد و نوشتن سازنده‌های تخصصی، نام‌گذاری شده کاهش یابند.
- **متورم**: منجر به یک حالت واحد می‌شود که می‌تواند با گذشت زمان با ویژگی‌های زیادی متورم شود.

#### حکم

این رویکرد برای حالت‌های ساده یا زمانی که نیازها حالت‌هایی را که انحصاری نیستند (مثلاً نمایش یک snackbar هنگام وقوع خطا در حالی که هنوز داده‌های قدیمی از آخرین حالت موفقیت را نشان می‌دهد) فراخوانی می‌کنند بهترین کار را می‌کند. این رویکرد انعطاف‌پذیری و کوتاهی را با هزینه ایمنی نوع فراهم می‌کند.

## کلاس Sealed و زیرکلاس‌ها

این رویکرد از یک **کلاس sealed** که هر ویژگی مشترکی را نگه می‌دارد و چندین زیرکلاس برای حالت‌های جداگانه تشکیل شده است. این رویکرد عالی برای حالت‌های جداگانه، انحصاری است.

<SealedClassAndSubclassesSnippet />

#### مزایا

- **ایمن از نظر نوع**: کد ایمن از کامپایل است و امکان دسترسی تصادفی به یک ویژگی نامعتبر وجود ندارد. هر زیرکلاس ویژگی‌های خود را نگه می‌دارد، که مشخص می‌کند کدام ویژگی‌ها به کدام حالت تعلق دارند.
- **صریح**: ویژگی‌های مشترک را از ویژگی‌های خاص حالت جدا می‌کند.
- **جامع**: استفاده از یک عبارت `switch` برای بررسی جامع بودن برای اطمینان از اینکه هر حالت به طور صریح مدیریت می‌شود.
  - اگر نمی‌خواهید [switching جامع](https://dart.dev/language/branches#exhaustiveness-checking) یا می‌خواهید بتوانید زیرنوع‌ها را بعداً بدون شکستن API اضافه کنید، از اصلاح‌کننده [final](https://dart.dev/language/class-modifiers#final) استفاده کنید.
  - برای جزئیات بیشتر، [مستندات کلاس sealed](https://dart.dev/language/class-modifiers#sealed) را ببینید.

#### معایب

- **طولانی**: نیاز به کد بیشتری دارد (یک کلاس پایه و یک زیرکلاس برای هر حالت). همچنین ممکن است نیاز به کد تکراری برای ویژگی‌های مشترک در زیرکلاس‌ها داشته باشد.
- **پیچیده**: افزودن ویژگی‌های جدید نیاز به به‌روزرسانی هر زیرکلاس و کلاس پایه دارد، که می‌تواند دشوار باشد و منجر به افزایش پیچیدگی حالت شود. علاوه بر این، ممکن است نیاز به بررسی نوع غیرضروری/زیادی برای دسترسی به ویژگی‌ها داشته باشد.

#### حکم

این رویکرد برای حالت‌های انحصاری، خوب تعریف‌شده با ویژگی‌های منحصر به فرد بهترین کار را می‌کند. این رویکرد ایمنی نوع و بررسی‌های جامع بودن را فراهم می‌کند و بر ایمنی نسبت به کوتاهی و سادگی تأکید دارد.
