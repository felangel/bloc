---
title: ุฏููู ุงูุงูุชูุงู (Migration Guide)
description: ุงูุชูู ุฅูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูุณุชูุฑ ูู Bloc.
---

import { Code, Tabs, TabItem } from '@astrojs/starlight/components';

:::tip

ูุฑุฌู ุงูุฑุฌูุน ุฅูู [ุณุฌู ุงูุฅุตุฏุงุฑุงุช](https://github.com/felangel/bloc/releases) ููุฒูุฏ
ูู ุงููุนูููุงุช ุญูู ุงูุชุบููุฑุงุช ูู ูู ุฅุตุฏุงุฑ.

:::

## v10.0.0

### `package:bloc_test`

#### โโจ ูุตู `blocTest` ุนู `BlocBase`

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc_test v10.0.0ุ ูู ูุนุฏ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ูู `blocTest`
ูุฑุชุจุทุฉ ุจุดูู ูุซูู ุจู `BlocBase`.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ูุฌุจ ุฃู ูุณุชุฎุฏู `blocTest` ูุงุฌูุงุช bloc ุงูุฃุณุงุณูุฉ ูููุง ุฃููู ุฐูู ูุฒูุงุฏุฉ ุงููุฑููุฉ
ููุงุจููุฉ ุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู. ุณุงุจูุงูุ ูู ููู ูุฐุง ููููุงู ูุฃู `BlocBase` ูุงู ูุทุจู
`StateStreamableSource` ููู ูุง ูู ููู ูุงููุงู ูู `blocTest` ุจุณุจุจ ุงูุงุนุชูุงุฏ ุงูุฏุงุฎูู
ุนูู API ุงูู `emit`.

### `package:hydrated_bloc`

#### โโจ ุฏุนู WebAssembly

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ hydrated_bloc v10.0.0ุ ุชูุช ุฅุถุงูุฉ ุฏุนู ููุชุฑุฌูุฉ ุงูุจุฑูุฌูุฉ (compiling) ุฅูู
WebAssembly (wasm).

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุณุงุจูุงูุ ูู ููู ูู ุงููููู ุชุฑุฌูุฉ ุงูุชุทุจููุงุช ุฅูู wasm ุนูุฏ ุงุณุชุฎุฏุงู `hydrated_bloc`.
ูู ุงูุฅุตุฏุงุฑ v10.0.0ุ ุชูุช ุฅุนุงุฏุฉ ููููุฉ ุงูุญุฒูุฉ ููุณูุงุญ ุจุงูุชุฑุฌูุฉ ุฅูู wasm.

**v9.x.x**

```dart
Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  HydratedBloc.storage = await HydratedStorage.build(
    storageDirectory: kIsWeb
        ? HydratedStorage.webStorageDirectory
        : await getTemporaryDirectory(),
  );
  runApp(App());
}
```

**v10.x.x**

```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  HydratedBloc.storage = await HydratedStorage.build(
    storageDirectory: kIsWeb
        ? HydratedStorageDirectory.web
        : HydratedStorageDirectory((await getTemporaryDirectory()).path),
  );
  runApp(const App());
}
```

## v9.0.0

### `package:bloc`

#### โ๐งน ุฅุฒุงูุฉ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (APIs) ุงูููุฌูุฑุฉ

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v9.0.0ุ ุชูุช ุฅุฒุงูุฉ ุฌููุน ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุชู ุชู ูุถุน ุนูุงูุฉ
"ููุฌูุฑุฉ" (deprecated) ุนูููุง ุณุงุจูุงู.

:::

##### ููุฎุต

- ุชูุช ุฅุฒุงูุฉ `BlocOverrides` ูุตุงูุญ `Bloc.observer` ู `Bloc.transformer`.

#### โโจ ุชูุฏูู ูุงุฌูุฉ `EmittableStateStreamableSource` ุงูุฌุฏูุฏุฉ

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v9.0.0ุ ุชู ุชูุฏูู ูุงุฌูุฉ ุฃุณุงุณูุฉ ุฌุฏูุฏุฉ ุชุณูู
`EmittableStateStreamableSource`.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ูุงูุช `package:bloc_test` ุณุงุจูุงู ูุฑุชุจุทุฉ ุจุดูู ูุซูู ุจู `BlocBase`. ุชู ุชูุฏูู ูุงุฌูุฉ
`EmittableStateStreamableSource` ููุณูุงุญ ุจูุตู `blocTest` ุนู ุงูุชุทุจูู ุงููุนูู ูู
`BlocBase`.

### `package:hydrated_bloc`

#### โจ ุฅุนุงุฏุฉ ุชูุฏูู API ุงูู `HydratedBloc.storage`

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ hydrated_bloc v9.0.0ุ ุชูุช ุฅุฒุงูุฉ `HydratedBlocOverrides` ูุตุงูุญ API ุงูู
`HydratedBloc.storage`.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุฑุงุฌุน
[ุงูุฃุณุจุงุจ ุงููุงููุฉ ูุฑุงุก ุฅุนุงุฏุฉ ุชูุฏูู ูุงุฌูุงุช Bloc.observer ู Bloc.transformer](/ar/migration/#-ุฅุนุงุฏุฉ-ุชูุฏูู-ูุงุฌูุงุช-ุจุฑูุฌุฉ-ุงูุชุทุจููุงุช-blocobserver-ู-bloctransformer).

**v8.x.x**

```dart
Future<void> main() async {
  final storage = await HydratedStorage.build(
    storageDirectory: kIsWeb
        ? HydratedStorage.webStorageDirectory
        : await getTemporaryDirectory(),
  );
  HydratedBlocOverrides.runZoned(
    () => runApp(App()),
    storage: storage,
  );
}
```

**v9.0.0**

```dart
Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  HydratedBloc.storage = await HydratedStorage.build(
    storageDirectory: kIsWeb
        ? HydratedStorage.webStorageDirectory
        : await getTemporaryDirectory(),
  );
  runApp(App());
}
```

## v8.1.0

### `package:bloc`

#### โจ ุฅุนุงุฏุฉ ุชูุฏูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช `Bloc.observer` ู `Bloc.transformer`

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v8.1.0ุ ุชู ูุถุน ุนูุงูุฉ "ููุฌูุฑ" ุนูู `BlocOverrides` ูุตุงูุญ ูุงุฌูุงุช
`Bloc.observer` ู `Bloc.transformer`.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุชู ุชูุฏูู API ุงูู `BlocOverrides` ูู ุงูุฅุตุฏุงุฑ v8.0.0 ูู ูุญุงููุฉ ูุฏุนู ูุทุงู (scoping)
ุฅุนุฏุงุฏุงุช ุงูู bloc ุงููุญุฏุฏุฉ ูุซู `BlocObserver` ู `EventTransformer` ู
`HydratedStorage`. ูู ุชุทุจููุงุช Dart ุงูุตุฑูุฉุ ุนููุช ุงูุชุบููุฑุงุช ุจุดูู ุฌูุฏุ ููุน ุฐููุ ูู
ุชุทุจููุงุช Flutterุ ุชุณุจุจ API ุงูุฌุฏูุฏ ูู ูุดุงูู ุฃูุซุฑ ููุง ุญููุง.

ุชู ุงุณุชููุงู API ุงูู `BlocOverrides` ูู ูุงุฌูุงุช ููุงุซูุฉ ูู Flutter/Dart:

- [HttpOverrides](https://api.flutter.dev/flutter/dart-io/HttpOverrides-class.html)
- [IOOverrides](https://api.flutter.dev/flutter/dart-io/IOOverrides-class.html)

**ุงููุดุงูู**

ุนูู ุงูุฑุบู ูู ุฃูู ูู ููู ุงูุณุจุจ ุงูุฑุฆูุณู ููุฐู ุงูุชุบููุฑุงุชุ ุฅูุง ุฃู API ุงูู
`BlocOverrides` ุฃุถุงู ุชุนููุฏุงู ุฅุถุงููุงู ูููุทูุฑูู. ูุจุงูุฅุถุงูุฉ ุฅูู ุฒูุงุฏุฉ ููุฏุงุฑ ุงูุชุฏุงุฎู
(nesting) ูุนุฏุฏ ุฃุณุทุฑ ุงูููุฏ ุงููุงุฒูุฉ ูุชุญููู ููุณ ุงูุชุฃุซูุฑุ ุชุทูุจ API ุงูู
`BlocOverrides` ูู ุงููุทูุฑูู ุฃู ูููู ูุฏููู ููู ููู ููู
[Zones](https://api.dart.dev/stable/2.17.6/dart-async/Zone-class.html) ูู Dart.
ุงูู `Zones` ููุณุช ูููููุงู ุณููุงู ูููุจุชุฏุฆููุ ูุงููุดู ูู ููู ููููุฉ ุนูููุง ูุฏ ูุคุฏู ุฅูู
ุธููุฑ ุฃุฎุทุงุก (ูุซู ุนุฏู ุชููุฆุฉ ุงููุฑุงูุจููุ ุงููุญููุงุชุ ุฃู ูุซููุงุช ุงูุชุฎุฒูู).

ุนูู ุณุจูู ุงููุซุงูุ ูุงู ูุฏู ุงูุนุฏูุฏ ูู ุงููุทูุฑูู ููุฏ ูุซู:

```dart
void main() {
  WidgetsFlutterBinding.ensureInitialized();
  BlocOverrides.runZoned(...);
}
```

ุงูููุฏ ุฃุนูุงูุ ุฑุบู ุฃูู ูุจุฏู ุบูุฑ ุถุงุฑุ ูููู ุฃู ูุคุฏู ูู ุงููุงูุน ุฅูู ุงูุนุฏูุฏ ูู ุงูุฃุฎุทุงุก
ุงูุชู ูุตุนุจ ุชุชุจุนูุง. ูุฃู Zone ูุชู ุงุณุชุฏุนุงุก `WidgetsFlutterBinding.ensureInitialized`
ูููุง ูู ุงูุจุฏุงูุฉ ุณุชููู ูู ุงูู Zone ุงูุชู ูุชู ูููุง ุงูุชุนุงูู ูุน ุฃุญุฏุงุซ ุงูุฅููุงุกุงุช (ูุซู
ุงุณุชุฏุนุงุกุงุช `onTap` ู `onPressed`) ุจุณุจุจ `GestureBinding.initInstances`. ูุฐู ูุฌุฑุฏ
ูุงุญุฏุฉ ูู ุงูุนุฏูุฏ ูู ุงููุดุงูู ุงููุงุฌูุฉ ุนู ุงุณุชุฎุฏุงู `zoneValues`.

ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ูููู Flutter ุจุงูุนุฏูุฏ ูู ุงูุฃุดูุงุก ุฎูู ุงูููุงููุณ ูุงูุชู ุชุชุถูู
ุชูุฑูุน/ุชุนุฏูู ุงูู Zones (ุฎุงุตุฉ ุนูุฏ ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช) ููุง ูุฏ ูุคุฏู ุฅูู ุณููููุงุช ุบูุฑ
ูุชููุนุฉ (ููู ูุซูุฑ ูู ุงูุญุงูุงุช ุณููููุงุช ุฎุงุฑุฌุฉ ุนู ุณูุทุฑุฉ ุงููุทูุฑ -- ุงูุธุฑ ุงููุดุงูู
ุฃุฏูุงู).

ุจุณุจุจ ุงุณุชุฎุฏุงู
[runZoned](https://api.flutter.dev/flutter/dart-async/runZoned.html)ุ ุฃุฏู
ุงูุงูุชูุงู ุฅูู API ุงูู `BlocOverrides` ุฅูู ุงูุชุดุงู ุงูุนุฏูุฏ ูู ุงูุฃุฎุทุงุก/ุงููููุฏ ูู
Flutter (ุชุญุฏูุฏุงู ุญูู ุงุฎุชุจุงุฑุงุช ุงูู Widget ูุงูู Integration):

- https://github.com/flutter/flutter/issues/96939
- https://github.com/flutter/flutter/issues/94123
- https://github.com/flutter/flutter/issues/93676

ูุงูุชู ุฃุซุฑุช ุนูู ุงูุนุฏูุฏ ูู ุงููุทูุฑูู ุงูุฐูู ูุณุชุฎุฏููู ููุชุจุฉ bloc:

- https://github.com/felangel/bloc/issues/3394
- https://github.com/felangel/bloc/issues/3350
- https://github.com/felangel/bloc/issues/3319

**v8.0.x**

```dart
void main() {
  BlocOverrides.runZoned(
    () {
      // ...
    },
    blocObserver: CustomBlocObserver(),
    eventTransformer: customEventTransformer(),
  );
}
```

**v8.1.0**

```dart
void main() {
  Bloc.observer = CustomBlocObserver();
  Bloc.transformer = customEventTransformer();

  // ...
}
```

## v8.0.0

### `package:bloc`

#### โโจ ุชูุฏูู API ุงูู `BlocOverrides` ุงูุฌุฏูุฏ

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v8.0.0ุ ุชูุช ุฅุฒุงูุฉ `Bloc.observer` ู `Bloc.transformer` ูุตุงูุญ API
ุงูู `BlocOverrides`.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ูุงู API ุงูุณุงุจู ุงููุณุชุฎุฏู ูุชุฌุงูุฒ ุงูู `BlocObserver` ูุงูู `EventTransformer`
ุงูุงูุชุฑุงุถููู ูุนุชูุฏ ุนูู "singleton" ุนุงููู ููู ููููุง.

ููุชูุฌุฉ ูุฐููุ ูู ููู ูู ุงููููู:

- ุงูุชูุงู ุชุทุจููุงุช ูุชุนุฏุฏุฉ ูู `BlocObserver` ุฃู `EventTransformer` ูุญุตูุฑุฉ ูู ุฃุฌุฒุงุก
  ูุฎุชููุฉ ูู ุงูุชุทุจูู.
- ุฌุนู ุชุฌุงูุฒุงุช `BlocObserver` ุฃู `EventTransformer` ูุญุตูุฑุฉ ูู ุญุฒูุฉ (package)
  ูุนููุฉ.
  - ุฅุฐุง ูุงูุช ุงูุญุฒูุฉ ุชุนุชูุฏ ุนูู `package:bloc` ูุณุฌูุช ุงูู `BlocObserver` ุงูุฎุงุต ุจูุงุ
    ูุณูุชุนูู ุนูู ุฃู ูุณุชุฎุฏู ููุญุฒูุฉ ุฅูุง ุงููุชุงุจุฉ ููู ุงูู `BlocObserver` ุงูุฎุงุต
    ุจุงูุญุฒูุฉ ุฃู ุฅุฑุณุงู ุงูุชูุงุฑูุฑ ุฅููู.

ููุง ูุงู ูู ุงูุตุนุจ ุฃูุถุงู ุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑุงุช ุจุณุจุจ ุงูุญุงูุฉ ุงูุนุงูููุฉ ุงููุดุชุฑูุฉ ุนุจุฑ
ุงูุงุฎุชุจุงุฑุงุช.

ููุฏู Bloc v8.0.0 ูุฆุฉ `BlocOverrides` ุงูุชู ุชุณูุญ ูููุทูุฑูู ุจุชุฌุงูุฒ `BlocObserver`
ู/ุฃู `EventTransformer` ูู `Zone` ูุนููุฉ ุจุฏูุงู ูู ุงูุงุนุชูุงุฏ ุนูู singleton ุนุงููู
ูุงุจู ููุชุบููุฑ.

**v7.x.x**

```dart
void main() {
  Bloc.observer = CustomBlocObserver();
  Bloc.transformer = customEventTransformer();

  // ...
}
```

**v8.0.0**

```dart
void main() {
  BlocOverrides.runZoned(
    () {
      // ...
    },
    blocObserver: CustomBlocObserver(),
    eventTransformer: customEventTransformer(),
  );
}
```

ุณุชุณุชุฎุฏู ูุซููุงุช `Bloc` ุงูู `BlocObserver` ู/ุฃู ุงูู `EventTransformer` ููู `Zone`
ุงูุญุงููุฉ ุนุจุฑ `BlocOverrides.current`. ุฅุฐุง ูู ุชูู ููุงู `BlocOverrides` ููู zoneุ
ูุณุชุณุชุฎุฏู ุงูููู ุงูุงูุชุฑุงุถูุฉ ุงูุฏุงุฎููุฉ ุงูููุฌูุฏุฉ (ูุง ุชุบููุฑ ูู ุงูุณููู/ุงููุธููุฉ).

ูุฐุง ูุณูุญ ููู `Zone` ุจุงูุนูู ุจุดูู ูุณุชูู ูุน `BlocOverrides` ุงูุฎุงุตุฉ ุจูุง.

```dart
BlocOverrides.runZoned(
  () {
    // BlocObserverA and eventTransformerA
    final overrides = BlocOverrides.current;

    // Blocs in this zone report to BlocObserverA
    // and use eventTransformerA as the default transformer.
    // ...

    // Later...
    BlocOverrides.runZoned(
      () {
        // BlocObserverB and eventTransformerB
        final overrides = BlocOverrides.current;

        // Blocs in this zone report to BlocObserverB
        // and use eventTransformerB as the default transformer.
        // ...
      },
      blocObserver: BlocObserverB(),
      eventTransformer: eventTransformerB(),
    );
  },
  blocObserver: BlocObserverA(),
  eventTransformer: eventTransformerA(),
);
```

#### โโจ ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงูุฅุจูุงุบ ุนููุง

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v8.0.0ุ ุชูุช ุฅุฒุงูุฉ `BlocUnhandledErrorException`. ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ
ูุชู ุฏุงุฆูุงู ุงูุฅุจูุงุบ ุนู ุฃู ุงุณุชุซูุงุกุงุช ุบูุฑ ููุชูุทุฉ ุฅูู `onError` ูุฅุนุงุฏุฉ ุฑูููุง (ุจุบุถ
ุงููุธุฑ ุนู ูุถุน ุงูุชุตุญูุญ "debug" ุฃู ุงูุฅุตุฏุงุฑ "release"). ูููู API ุงูู `addError`
ุจุงูุฅุจูุงุบ ุนู ุงูุฃุฎุทุงุก ุฅูู `onError` ููููู ูุง ูุนุงูู ุงูุฃุฎุทุงุก ุงููุจูุบ ุนููุง ูุงุณุชุซูุงุกุงุช
ุบูุฑ ููุชูุทุฉ.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุงููุฏู ูู ูุฐู ุงูุชุบููุฑุงุช ูู:

- ุฌุนู ุงูุงุณุชุซูุงุกุงุช ุงูุฏุงุฎููุฉ ุบูุฑ ุงููุนุงูุฌุฉ ูุงุถุญุฉ ููุบุงูุฉ ูุน ุงูุญูุงุธ ุนูู ูุธุงุฆู bloc.
- ุฏุนู `addError` ุฏูู ุชุนุทูู ุชุฏูู ุงูุชุญูู.

ุณุงุจูุงูุ ูุงู ุงูุชุนุงูู ูุน ุงูุฃุฎุทุงุก ูุงูุฅุจูุงุบ ุนููุง ูุฎุชูู ุงุนุชูุงุฏุงู ุนูู ูุง ุฅุฐุง ูุงู
ุงูุชุทุจูู ูุนูู ูู ูุถุน debug ุฃู release. ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ูุงูุช ุงูุฃุฎุทุงุก ุงููุจูุบ ุนููุง
ุนุจุฑ `addError` ุชูุนุงูู ูุงุณุชุซูุงุกุงุช ุบูุฑ ููุชูุทุฉ ูู ูุถุน debugุ ููุง ุฃุฏู ุฅูู ุชุฌุฑุจุฉ ูุทูุฑ
ุณูุฆุฉ ุนูุฏ ุงุณุชุฎุฏุงู API ุงูู `addError` (ุชุญุฏูุฏุงู ุนูุฏ ูุชุงุจุฉ ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ).

ูู v8.0.0ุ ูููู ุงุณุชุฎุฏุงู `addError` ุจุฃูุงู ููุฅุจูุงุบ ุนู ุงูุฃุฎุทุงุก ููููู ุงุณุชุฎุฏุงู
`blocTest` ููุชุญูู ูู ุงูุฅุจูุงุบ ุนู ุงูุฃุฎุทุงุก. ูุง ุชุฒุงู ุฌููุน ุงูุฃุฎุทุงุก ุชูุจูุบ ุฅูู
`onError`ุ ููุน ุฐููุ ูุชู ููุท ุฅุนุงุฏุฉ ุฑูู ุงูุงุณุชุซูุงุกุงุช ุบูุฑ ุงูููุชูุทุฉ (ุจุบุถ ุงููุธุฑ ุนู ูุถุน
debug ุฃู release).

#### โ๐งน ุฌุนู `BlocObserver` ูุฆุฉ ูุฌุฑุฏุฉ (abstract)

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v8.0.0ุ ุชู ุชุญููู `BlocObserver` ุฅูู ูุฆุฉ `abstract` ููุง ูุนูู ุฃูู ูุง
ูููู ุฅูุดุงุก ูุซูู (instance) ูู `BlocObserver` ูุจุงุดุฑุฉ.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ูุงู ุงูููุตูุฏ ูู `BlocObserver` ุฃู ูููู ูุงุฌูุฉ (interface). ูุจูุง ุฃู ุงูุชุทุจููุงุช
ุงูุงูุชุฑุงุถูุฉ ููู API ูู ุนูููุงุช ูุงุฑุบุฉ (no-ops)ุ ูุฅู `BlocObserver` ุงูุขู ูุฆุฉ
`abstract` ููุชูุงุตู ุจูุถูุญ ุจุฃู ุงููุฆุฉ ูุฎุตุตุฉ ููุชูุณูุน ูููุณ ูุฅูุดุงุก ูุซููุงุช ูููุง ูุจุงุดุฑุฉ.

**v7.x.x**

```dart
void main() {
  // ูุงู ูู ุงููููู ุฅูุดุงุก ูุซูู ูู ุงููุฆุฉ ุงูุฃุณุงุณูุฉ.
```

final observer = BlocObserver(); }

````

**v8.0.0**

```dart
class MyBlocObserver extends BlocObserver {...}

void main() {
  // ูุง ูููู ุฅูุดุงุก ูุซูู ูู ุงููุฆุฉ ุงูุฃุณุงุณูุฉ.
  final observer = BlocObserver(); // ุฎุทุฃ (ERROR)

  // ูู ุจุชูุณูุน `BlocObserver` ุจุฏูุงู ูู ุฐูู.
  final observer = MyBlocObserver(); // ููุจูู (OK)
}
````

#### โโจ ุงุณุชุฏุนุงุก `add` ูุฑูู `StateError` ุฅุฐุง ูุงู ุงูู Bloc ูุบููุงู

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v8.0.0ุ ุณูุคุฏู ุงุณุชุฏุนุงุก `add` ุนูู bloc ูุบูู ุฅูู ุญุฏูุซ `StateError`.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุณุงุจูุงูุ ูุงู ูู ุงููููู ุงุณุชุฏุนุงุก `add` ุนูู bloc ูุบูู ููุงู ุงูุฎุทุฃ ุงูุฏุงุฎูู ูุชู ุชุฌุงูููุ
ููุง ูุฌุนู ูู ุงูุตุนุจ ุชุตุญูุญ ุณุจุจ ุนุฏู ูุนุงูุฌุฉ ุงูุญุฏุซ ุงููุถุงู. ูุฌุนู ูุฐุง ุงูุณููุงุฑูู ุฃูุซุฑ
ูุถูุญุงูุ ูู v8.0.0ุ ุณูุคุฏู ุงุณุชุฏุนุงุก `add` ุนูู bloc ูุบูู ุฅูู ุฑูู `StateError` ูุงูุฐู
ุณูุชู ุงูุฅุจูุงุบ ุนูู ูุงุณุชุซูุงุก ุบูุฑ ููุชูุท ูุชูุฑูุฑู ุฅูู `onError`.

#### โโจ ุงุณุชุฏุนุงุก `emit` ูุฑูู `StateError` ุฅุฐุง ูุงู ุงูู Bloc ูุบููุงู

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v8.0.0ุ ุณูุคุฏู ุงุณุชุฏุนุงุก `emit` ุฏุงุฎู bloc ูุบูู ุฅูู ุญุฏูุซ `StateError`.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุณุงุจูุงูุ ูุงู ูู ุงููููู ุงุณุชุฏุนุงุก `emit` ุฏุงุฎู bloc ูุบูู ููู ููู ูุญุฏุซ ุฃู ุชุบููุฑ ูู
ุงูุญุงูุฉุ ูููู ูู ููู ููุงู ุฃูุถุงู ุฃู ุฅุดุงุฑุฉ ุฅูู ุงูุฎุทุฃุ ููุง ูุฌุนู ุงูุชุตุญูุญ ุตุนุจุงู. ูุฌุนู
ูุฐุง ุงูุณููุงุฑูู ุฃูุซุฑ ูุถูุญุงูุ ูู v8.0.0ุ ุณูุคุฏู ุงุณุชุฏุนุงุก `emit` ุฏุงุฎู bloc ูุบูู ุฅูู
ุฑูู `StateError` ูุงูุฐู ุณูุชู ุงูุฅุจูุงุบ ุนูู ูุงุณุชุซูุงุก ุบูุฑ ููุชูุท ูุชูุฑูุฑู ุฅูู
`onError`.

#### โ๐งน ุฅุฒุงูุฉ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (APIs) ุงูููุฌูุฑุฉ

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v8.0.0ุ ุชูุช ุฅุฒุงูุฉ ุฌููุน ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุชู ุชู ูุถุน ุนูุงูุฉ
"ููุฌูุฑุฉ" ุนูููุง ุณุงุจูุงู.

:::

##### ููุฎุต

- ุชูุช ุฅุฒุงูุฉ `mapEventToState` ูุตุงูุญ `on<Event>`.
- ุชูุช ุฅุฒุงูุฉ `transformEvents` ูุตุงูุญ API ุงูู `EventTransformer`.
- ุชูุช ุฅุฒุงูุฉ ุชุนุฑูู ุงูููุน `TransitionFunction` ูุตุงูุญ API ุงูู `EventTransformer`.
- ุชูุช ุฅุฒุงูุฉ `listen` ูุตุงูุญ `stream.listen`.

### `package:bloc_test`

#### โจ `MockBloc` ู `MockCubit` ูู ูุนูุฏุง ูุชุทูุจุงู `registerFallbackValue`

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc_test v9.0.0ุ ูู ูุนุฏ ุงููุทูุฑูู ุจุญุงุฌุฉ ุฅูู ุงุณุชุฏุนุงุก
`registerFallbackValue` ุตุฑุงุญุฉู ุนูุฏ ุงุณุชุฎุฏุงู `MockBloc` ุฃู `MockCubit`.

:::

##### ููุฎุต

ุชููู ููุงู ุญุงุฌุฉ ูู `registerFallbackValue` ููุท ุนูุฏ ุงุณุชุฎุฏุงู ุงููุทุงุจู `any()` ูู
`package:mocktail` ูููุน ูุฎุตุต. ุณุงุจูุงูุ ูุงูุช ููุงู ุญุงุฌุฉ ูู `registerFallbackValue`
ููู `Event` ู `State` ุนูุฏ ุงุณุชุฎุฏุงู `MockBloc` ุฃู `MockCubit`.

**v8.x.x**

```dart
class FakeMyEvent extends Fake implements MyEvent {}
class FakeMyState extends Fake implements MyState {}
class MyMockBloc extends MockBloc<MyEvent, MyState> implements MyBloc {}

void main() {
  setUpAll(() {
    registerFallbackValue(FakeMyEvent());
    registerFallbackValue(FakeMyState());
  });

  // ุงูุงุฎุชุจุงุฑุงุช...
}
```

**v9.0.0**

```dart
class MyMockBloc extends MockBloc<MyEvent, MyState> implements MyBloc {}

void main() {
  // ุงูุงุฎุชุจุงุฑุงุช...
}
```

### `package:hydrated_bloc`

#### โโจ ุชูุฏูู API ุงูู `HydratedBlocOverrides` ุงูุฌุฏูุฏ

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ hydrated_bloc v8.0.0ุ ุชูุช ุฅุฒุงูุฉ `HydratedBloc.storage` ูุตุงูุญ API ุงูู
`HydratedBlocOverrides`.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุณุงุจูุงูุ ูุงู ูุชู ุงุณุชุฎุฏุงู singleton ุนุงููู ูุชุฌุงูุฒ ุชุทุจูู ุงูู `Storage`.

ููุชูุฌุฉ ูุฐููุ ูู ููู ูู ุงููููู ุงูุชูุงู ุชุทุจููุงุช `Storage` ูุชุนุฏุฏุฉ ูุญุตูุฑุฉ ูู ุฃุฌุฒุงุก
ูุฎุชููุฉ ูู ุงูุชุทุจูู. ููุง ูุงู ูู ุงูุตุนุจ ุฃูุถุงู ุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑุงุช ุจุณุจุจ ุงูุญุงูุฉ ุงูุนุงูููุฉ
ุงููุดุชุฑูุฉ ุนุจุฑ ุงูุงุฎุชุจุงุฑุงุช.

ููุฏู `HydratedBloc` v8.0.0 ูุฆุฉ `HydratedBlocOverrides` ุงูุชู ุชุณูุญ ูููุทูุฑูู ุจุชุฌุงูุฒ
ุงูู `Storage` ูู `Zone` ูุนููุฉ ุจุฏูุงู ูู ุงูุงุนุชูุงุฏ ุนูู singleton ุนุงููู ูุงุจู
ููุชุบููุฑ.

**v7.x.x**

```dart
void main() async {
  HydratedBloc.storage = await HydratedStorage.build(
    storageDirectory: await getApplicationSupportDirectory(),
  );

  // ...
}
```

**v8.0.0**

```dart
void main() {
  final storage = await HydratedStorage.build(
    storageDirectory: await getApplicationSupportDirectory(),
  );

  HydratedBlocOverrides.runZoned(
    () {
      // ...
    },
    storage: storage,
  );
}
```

ุณุชุณุชุฎุฏู ูุซููุงุช `HydratedBloc` ุงูู `Storage` ููู `Zone` ุงูุญุงููุฉ ุนุจุฑ
`HydratedBlocOverrides.current`.

ูุฐุง ูุณูุญ ููู `Zone` ุจุงูุนูู ุจุดูู ูุณุชูู ูุน `BlocOverrides` ุงูุฎุงุตุฉ ุจูุง.

## v7.2.0

### `package:bloc`

#### โจ ุชูุฏูู API ุงูู `on<Event>` ุงูุฌุฏูุฏ

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v7.2.0ุ ุชู ูุถุน ุนูุงูุฉ "ููุฌูุฑ" ุนูู `mapEventToState` ูุตุงูุญ
`on<Event>`. ุณูุชู ุฅุฒุงูุฉ `mapEventToState` ูู ุฅุตุฏุงุฑ bloc v8.0.0.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุชู ุชูุฏูู API ุงูู `on<Event>` ูุฌุฒุก ูู
[ููุชุฑุญ ุงุณุชุจุฏุงู mapEventToState ุจู on\<Event\> ูู Bloc](https://github.com/felangel/bloc/issues/2526).
ุจุณุจุจ [ูุดููุฉ ูู Dart](https://github.com/dart-lang/sdk/issues/44616)ุ ููุณ ูู
ุงููุงุถุญ ุฏุงุฆูุงู ูุง ุณุชููู ุนููู ูููุฉ ุงูู `state` ุนูุฏ ุงูุชุนุงูู ูุน ูููุฏุงุช ุบูุฑ ูุชุฒุงููุฉ
ูุชุฏุงุฎูุฉ (`async*`). ุนูู ุงูุฑุบู ูู ูุฌูุฏ ุทุฑู ููุงูุชูุงู ุนูู ุงููุดููุฉุ ุฅูุง ุฃู ุฃุญุฏ
ุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ ูููุชุจุฉ bloc ูู ุฃู ุชููู ูุงุจูุฉ ููุชูุจุค. ุชู ุฅูุดุงุก API ุงูู
`on<Event>` ูุฌุนู ุงูููุชุจุฉ ุขููุฉ ูุฏุฑ ุงูุฅููุงู ููุงุณุชุฎุฏุงู ููููุถุงุก ุนูู ุฃู ุดู ูููุง ูุชุนูู
ุจุชุบููุฑุงุช ุงูุญุงูุฉ.

:::tip

ููุฒูุฏ ูู ุงููุนูููุงุชุ
[ุงูุฑุฃ ุงูููุชุฑุญ ุงููุงูู](https://github.com/felangel/bloc/issues/2526).

:::

##### ููุฎุต

ูุณูุญ ูู `on<E>` ุจุชุณุฌูู ูุนุงูุฌ ุฃุญุฏุงุซ (event handler) ูุฌููุน ุงูุฃุญุฏุงุซ ูู ุงูููุน `E`.
ุจุดูู ุงูุชุฑุงุถูุ ุณูุชู ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ ุจุดูู ูุชุฒุงูู (concurrently) ุนูุฏ ุงุณุชุฎุฏุงู `on<E>`
ุนูู ุนูุณ `mapEventToState` ุงูุฐู ูุนุงูุฌ ุงูุฃุญุฏุงุซ ุจุดูู ุชุณูุณูู (`sequentially`).

**v7.1.0**

```dart
abstract class CounterEvent {}
class Increment extends CounterEvent {}

class CounterBloc extends Bloc<CounterEvent, int> {
  CounterBloc() : super(0);

  @override
  Stream<int> mapEventToState(CounterEvent event) async* {
    if (event is Increment) {
      yield state + 1;
    }
  }
}
```

**v7.2.0**

```dart
abstract class CounterEvent {}
class Increment extends CounterEvent {}

class CounterBloc extends Bloc<CounterEvent, int> {
  CounterBloc() : super(0) {
    on<Increment>((event, emit) => emit(state + 1));
  }
}
```

:::note

ูุนูู ูู `EventHandler` ูุณุฌู ุจุดูู ูุณุชููุ ูุฐุง ูู ุงูููู ุชุณุฌูู ูุนุงูุฌุงุช ุงูุฃุญุฏุงุซ ุจูุงุกู
ุนูู ููุน ุงููุญูู (transformer) ุงูุฐู ุชุฑุบุจ ูู ุชุทุจููู.

:::

ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงูุงุญุชูุงุธ ุจููุณ ุงูุณููู ุชูุงูุงู ููุง ูู v7.1.0ุ ููููู ุชุณุฌูู ูุนุงูุฌ
ุฃุญุฏุงุซ ูุงุญุฏ ูุฌููุน ุงูุฃุญุฏุงุซ ูุชุทุจูู ูุญูู ุชุณูุณูู (`sequential` transformer):

```dart
import 'package:bloc/bloc.dart';
import 'package:bloc_concurrency/bloc_concurrency.dart';

class MyBloc extends Bloc<MyEvent, MyState> {
  MyBloc() : super(MyState()) {
    on<MyEvent>(_onEvent, transformer: sequential())
  }

  FutureOr<void> _onEvent(MyEvent event, Emitter<MyState> emit) async {
    // TODO: ุงูููุทู ุงูุจุฑูุฌู ููุถุน ููุง...
  }
}
```

ููููู ุฃูุถุงู ุชุฌุงูุฒ ุงูู `EventTransformer` ุงูุงูุชุฑุงุถู ูุฌููุน ุงูู blocs ูู ุชุทุจููู:

```dart
import 'package:bloc/bloc.dart';
import 'package:bloc_concurrency/bloc_concurrency.dart';

void main() {
  Bloc.transformer = sequential<dynamic>();
  ...
}
```

#### โจ ุชูุฏูู API ุงูู `EventTransformer` ุงูุฌุฏูุฏ

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v7.2.0ุ ุชู ูุถุน ุนูุงูุฉ "ููุฌูุฑ" ุนูู `transformEvents` ูุตุงูุญ API ุงูู
`EventTransformer`. ุณูุชู ุฅุฒุงูุฉ `transformEvents` ูู ุฅุตุฏุงุฑ bloc v8.0.0.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ูุชุญ API ุงูู `on<Event>` ุงูุจุงุจ ุฃูุงู ุงููุฏุฑุฉ ุนูู ุชูููุฑ ูุญูู ุฃุญุฏุงุซ ูุฎุตุต ููู ูุนุงูุฌ
ุฃุญุฏุงุซ. ุชู ุชูุฏูู ุชุนุฑูู ููุน (typedef) ุฌุฏูุฏ ุจุงุณู `EventTransformer` ูุงูุฐู ููููู
ุงููุทูุฑูู ูู ุชุญููู ุชุฏูู ุงูุฃุญุฏุงุซ ุงููุงุฑุฏุฉ ููู ูุนุงูุฌ ุฃุญุฏุงุซ ุจุฏูุงู ูู ุงูุงุถุทุฑุงุฑ ุฅูู
ุชุญุฏูุฏ ูุญูู ุฃุญุฏุงุซ ูุงุญุฏ ูุฌููุน ุงูุฃุญุฏุงุซ.

##### ููุฎุต

ุงูู `EventTransformer` ูุณุคูู ุนู ุฃุฎุฐ ุชุฏูู ุงูุฃุญุฏุงุซ ุงููุงุฑุฏุฉ ุฌูุจุงู ุฅูู ุฌูุจ ูุน
`EventMapper` (ูุนุงูุฌ ุงูุฃุญุฏุงุซ ุงูุฎุงุต ุจู) ูุฅุฑุฌุงุน ุชุฏูู ุฌุฏูุฏ ูู ุงูุฃุญุฏุงุซ.

```dart
typedef EventTransformer<Event> = Stream<Event> Function(Stream<Event> events, EventMapper<Event> mapper)
```

ูููู ุงูู `EventTransformer` ุงูุงูุชุฑุงุถู ุจูุนุงูุฌุฉ ุฌููุน ุงูุฃุญุฏุงุซ ุจุดูู ูุชุฒุงูู ููุจุฏู
ูุงูุชุงูู:

```dart
EventTransformer<E> concurrent<E>() {
  return (events, mapper) => events.flatMap(mapper);
}
```

:::tip

ุชุญูู ูู [package:bloc_concurrency](https://pub.dev/packages/bloc_concurrency)
ููุญุตูู ุนูู ูุฌููุนุฉ ูุฎุชุงุฑุฉ ูู ูุญููุงุช ุงูุฃุญุฏุงุซ ุงููุฎุตุตุฉ.

:::

**v7.1.0**

```dart
@override
Stream<Transition<MyEvent, MyState>> transformEvents(events, transitionFn) {
  return events
    .debounceTime(const Duration(milliseconds: 300))
    .flatMap(transitionFn);
}
```

**v7.2.0**

```dart
/// ุชุนุฑูู `EventTransformer` ูุฎุตุต
EventTransformer<MyEvent> debounce<MyEvent>(Duration duration) {
  return (events, mapper) => events.debounceTime(duration).flatMap(mapper);
}

MyBloc() : super(MyState()) {
  /// ุชุทุจูู ุงูู `EventTransformer` ุงููุฎุตุต ุนูู ุงูู `EventHandler`
  on<MyEvent>(_onEvent, transformer: debounce(const Duration(milliseconds: 300)))
}
```

#### โ๏ธ ูุถุน ุนูุงูุฉ "ููุฌูุฑ" ุนูู API ุงูู `transformTransitions`

:::note[ูุง ุงูุฐู ุชุบูุฑุ]

ูู ุฅุตุฏุงุฑ bloc v7.2.0ุ ุชู ูุถุน ุนูุงูุฉ "ููุฌูุฑ" ุนูู `transformTransitions` ูุตุงูุญ
ุชุฌุงูุฒ API ุงูู `stream`. ุณูุชู ุฅุฒุงูุฉ `transformTransitions` ูู ุฅุตุฏุงุฑ bloc v8.0.0.

:::

##### ุงูุฃุณุจุงุจ (Rationale)

ุชุฌุนู ุฃุฏุงุฉ ุงูุญุตูู (getter) ุงูู `stream` ูู `Bloc` ูู ุงูุณูู ุชุฌุงูุฒ ุชุฏูู ุงูุญุงูุงุช
ุงูุตุงุฏุฑุ ูุจุงูุชุงูู ูู ูุนุฏ ูู ุงููููุฏ ุงูุญูุงุธ ุนูู API ูููุตู ูู
`transformTransitions`.

##### ููุฎุต

**v7.1.0**

```dart
@override
Stream<Transition<Event, State>> transformTransitions(
  Stream<Transition<Event, State>> transitions,
) {
  return transitions.debounceTime(const Duration(milliseconds: 42));
}
```

**v7.2.0**

```dart
@override
Stream<State> get stream => super.stream.debounceTime(const Duration(milliseconds: 42));
```

## v7.0.0

### `package:bloc`

#### โ ุงูู Bloc ูุงูู Cubit ููุณุนุงู `BlocBase`

##### ุงูุฃุณุจุงุจ (Rationale)

ููุทูุฑุ ูุงูุช ุงูุนูุงูุฉ ุจูู ุงูู blocs ูุงูู cubits ุบุฑูุจุฉ ุจุนุถ ุงูุดูุก. ุนูุฏูุง ุชู ุชูุฏูู
cubit ูุฃูู ูุฑุฉุ ุจุฏุฃ ููุฆุฉ ุฃุณุงุณูุฉ ููู blocsุ ููู ูุง ูุงู ููุทููุงู ูุฃูู ูุงู ูุญุชูู ุนูู
ูุฌููุนุฉ ูุฑุนูุฉ ูู ุงููุธุงุฆู ููุงู ุงูู blocs ููุณุนูู Cubit ุจุจุณุงุทุฉ ููุนุฑููู ูุงุฌูุงุช ุจุฑูุฌุฉ
ุชุทุจููุงุช ุฅุถุงููุฉ. ุฌุงุก ุฐูู ูุน ุจุนุถ ุงูุนููุจ:

- ูุงู ูุงุจุฏ ูู ุฅุนุงุฏุฉ ุชุณููุฉ ุฌููุน ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุชูุจู cubit ูู ุฃุฌู ุงูุฏูุฉุ
  ุฃู ูุงู ูุงุจุฏ ูู ุฅุจูุงุฆูุง ูู bloc ูู ุฃุฌู ุงูุงุชุณุงู ุนูู ุงูุฑุบู ูู ุฃููุง ุบูุฑ ุฏูููุฉ
  ูุฑููุงู ([#1708](https://github.com/felangel/bloc/issues/1708)ุ
  [#1560](https://github.com/felangel/bloc/issues/1560)).

- ูุงู ุนูู Cubit ุชูุณูุน Stream ูุชุทุจูู EventSink ูู ุฃุฌู ุงูุญุตูู ุนูู ูุงุนุฏุฉ ูุดุชุฑูุฉ
  ูููู ุจูุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุซู BlocBuilder ู BlocListener ูุบูุฑูุง ุนูููุง
  ([#1429](https://github.com/felangel/bloc/issues/1429)).

ูุงุญูุงูุ ุฌุฑุจูุง ุนูุณ ุงูุนูุงูุฉ ูุฌุนู bloc ูู ุงููุงุนุฏุฉ

ูุงูุฐู ุญู ุฌุฒุฆูุงู ุงูููุทุฉ ุงูุฃููู ุฃุนูุงู ููููู ูุฏู ูุดุงูู ุฃุฎุฑู:

- ุฃุตุจุญ API ุงูู cubit ูุชุถุฎูุงู ุจุณุจุจ ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช bloc ุงูุฃุณุงุณูุฉ ูุซู mapEventToState ู add ูุบูุฑูุง ([#2228](https://github.com/felangel/bloc/issues/2228)).
  - ูููู ูููุทูุฑูู ุชูููุงู ุงุณุชุฏุนุงุก ูุฐู ุงููุงุฌูุงุช ูุชุฎุฑูุจ ุงูุฃุดูุงุก.
- ูุง ูุฒุงู ููุงุฌู ููุณ ุงููุดููุฉ ุงููุชูุซูุฉ ูู ูุดู cubit ููุงูู API ุงูู stream ููุง ูุงู ูู ูุจู ([#1429](https://github.com/felangel/bloc/issues/1429)).

ููุนุงูุฌุฉ ูุฐู ุงููุดููุงุชุ ูุฏููุง ูุฆุฉ ุฃุณุงุณูุฉ ููู ูู `Bloc` ู `Cubit` ุชุณูู `BlocBase` ุจุญูุซ ูุง ุชุฒุงู ุงูููููุงุช ุงูุนูููุฉ ูุงุฏุฑุฉ ุนูู ุงูุชุนุงูู ูุน ูู ูู ูุซููุงุช bloc ู cubit ูููู ุฏูู ูุดู ูุงูู ูุงุฌูุงุช `Stream` ู `EventSink` ูุจุงุดุฑุฉ.

##### ููุฎุต

**BlocObserver**

**v6.1.x**

```dart
class SimpleBlocObserver extends BlocObserver {
  @override
  void onCreate(Cubit cubit) {...}

  @override
  void onEvent(Bloc bloc, Object event) {...}

  @override
  void onChange(Cubit cubit, Object event) {...}

  @override
  void onTransition(Bloc bloc, Transition transition) {...}

  @override
  void onError(Cubit cubit, Object error, StackTrace stackTrace) {...}

  @override
  void onClose(Cubit cubit) {...}
}
```

**v7.0.0**

```dart
class SimpleBlocObserver extends BlocObserver {
  @override
  void onCreate(BlocBase bloc) {...}

  @override
  void onEvent(Bloc bloc, Object event) {...}

  @override
  void onChange(BlocBase bloc, Object? event) {...}

  @override
  void onTransition(Bloc bloc, Transition transition) {...}

  @override
  void onError(BlocBase bloc, Object error, StackTrace stackTrace) {...}

  @override
  void onClose(BlocBase bloc) {...}
}
```

**Bloc/Cubit**

**v6.1.x**

```dart
final bloc = MyBloc();
bloc.listen((state) {...});

final cubit = MyCubit();
cubit.listen((state) {...});
```

**v7.0.0**

```dart
final bloc = MyBloc();
bloc.stream.listen((state) {...});

final cubit = MyCubit();
cubit.stream.listen((state) {...});
```

### `package:bloc_test`

#### โ `seed` ุชุฑุฌุน ุฏุงูุฉ ูุฏุนู ุงูููู ุงูุฏููุงููููุฉ

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ุฃุฌู ุฏุนู ูุฌูุฏ ูููุฉ "ุจุฐุฑุฉ" (seed) ูุงุจูุฉ ููุชุบููุฑ ููููู ุชุญุฏูุซูุง ุฏููุงููููุงู ูู
`setUp` ุ ูุฅู `seed` ุชุฑุฌุน ุฏุงูุฉ.

##### ููุฎุต

**v7.x.x**

```dart
blocTest(
  '...',
  seed: MyState(),
  ...
);
```

**v8.0.0**

```dart
blocTest(
  '...',
  seed: () => MyState(),
  ...
);
```

#### โ `expect` ุชุฑุฌุน ุฏุงูุฉ ูุฏุนู ุงูููู ุงูุฏููุงููููุฉ ูุชุชุถูู ุฏุนู ุงูู matcher

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ุฃุฌู ุฏุนู ูุฌูุฏ ุชููุน (expectation) ูุงุจู ููุชุบููุฑ ููููู ุชุญุฏูุซู ุฏููุงููููุงู ูู
`setUp` ุ ูุฅู `expect` ุชุฑุฌุน ุฏุงูุฉ. ููุง ูุฏุนู `expect` ุฃูุถุงู ุงูู `Matchers`.

##### ููุฎุต

**v7.x.x**

```dart
blocTest(
  '...',
  expect: [MyStateA(), MyStateB()],
  ...
);
```

**v8.0.0**

```dart
blocTest(
  '...',
  expect: () => [MyStateA(), MyStateB()],
  ...
);

// ูููู ุฃู ูููู ุฃูุถุงู `Matcher`
blocTest(
  '...',
  expect: () => contains(MyStateA()),
  ...
);
```

#### โ `errors` ุชุฑุฌุน ุฏุงูุฉ ูุฏุนู ุงูููู ุงูุฏููุงููููุฉ ูุชุชุถูู ุฏุนู ุงูู matcher

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ุฃุฌู ุฏุนู ูุฌูุฏ ุฃุฎุทุงุก ูุงุจูุฉ ููุชุบููุฑ ููููู ุชุญุฏูุซูุง ุฏููุงููููุงู ูู `setUp` ุ ูุฅู
`errors` ุชุฑุฌุน ุฏุงูุฉ. ููุง ูุฏุนู `errors` ุฃูุถุงู ุงูู `Matchers`.

##### ููุฎุต

**v7.x.x**

```dart
blocTest(
  '...',
  errors: [MyError()],
  ...
);
```

**v8.0.0**

```dart
blocTest(
  '...',
  errors: () => [MyError()],
  ...
);

// ูููู ุฃู ูููู ุฃูุถุงู `Matcher`
blocTest(
  '...',
  errors: () => contains(MyError()),
  ...
);
```

#### โ MockBloc ู MockCubit

##### ุงูุฃุณุจุงุจ (Rationale)

ูุฏุนู ูุญุงูุงุฉ (stubbing) ูุฎุชูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุฃุณุงุณูุฉุ ูุชู ุชุตุฏูุฑ
`MockBloc` ู `MockCubit` ูุฌุฒุก ูู ุญุฒูุฉ `bloc_test`. ุณุงุจูุงูุ ูุงู ูุฌุจ ุงุณุชุฎุฏุงู
`MockBloc` ููู ูู ูุซููุงุช `Bloc` ู `Cubit` ููู ูุง ูู ููู ุจุฏูููุงู.

##### ููุฎุต

**v7.x.x**

```dart
class MockMyBloc extends MockBloc<MyState> implements MyBloc {}
class MockMyCubit extends MockBloc<MyState> implements MyBloc {}
```

**v8.0.0**

```dart
class MockMyBloc extends MockBloc<MyEvent, MyState> implements MyBloc {}
class MockMyCubit extends MockCubit<MyState> implements MyCubit {}
```

#### โ ุงูุชูุงูู ูุน Mocktail

##### ุงูุฃุณุจุงุจ (Rationale)

ูุธุฑุงู ูููููุฏ ุงููุฎุชููุฉ ูุญุฒูุฉ [package:mockito](https://pub.dev/packages/mockito)
ุงูุขููุฉ ูู ุงูููู ุงูุฎุงููุฉ (null-safe) ูุงูููุถุญุฉ
[ููุง](https://github.com/dart-lang/mockito/blob/master/NULL_SAFETY_README.md#problems-with-typical-mocking-and-stubbing)ุ
ูุชู ุงุณุชุฎุฏุงู [package:mocktail](https://pub.dev/packages/mocktail) ุจูุงุณุทุฉ
`MockBloc` ู `MockCubit`. ูุชูุญ ุฐูู ูููุทูุฑูู ุงูุงุณุชูุฑุงุฑ ูู ุงุณุชุฎุฏุงู ูุงุฌูุฉ ูุญุงูุงุฉ
ูุฃูููุฉ ุฏูู ุงูุญุงุฌุฉ ุฅูู ูุชุงุจุฉ stubs ูุฏููุงู ุฃู ุงูุงุนุชูุงุฏ ุนูู ุชูููุฏ ุงูููุฏ.

##### ููุฎุต

**v7.x.x**

```dart
import 'package:mockito/mockito.dart';

...

when(bloc.state).thenReturn(MyState());
verify(bloc.add(any)).called(1);
```

**v8.0.0**

```dart
import 'package:mocktail/mocktail.dart';

...

when(() => bloc.state).thenReturn(MyState());
verify(() => bloc.add(any())).called(1);
```

> ูุฑุฌู ุงูุฑุฌูุน ุฅูู [#347](https://github.com/dart-lang/mockito/issues/347)
> ุจุงูุฅุถุงูุฉ ุฅูู
> [ุชูุซูู mocktail](https://github.com/felangel/mocktail/tree/main/packages/mocktail)
> ููุฒูุฏ ูู ุงููุนูููุงุช.

### `package:flutter_bloc`

#### โ ุฅุนุงุฏุฉ ุชุณููุฉ ูุนุงูู `cubit` ุฅูู `bloc`

##### ุงูุฃุณุจุงุจ (Rationale)

ูุชูุฌุฉ ูุฅุนุงุฏุฉ ุงูููููุฉ ูู `package:bloc` ูุชูุฏูู `BlocBase` ุงูุฐู ููุณุนู ูู ูู `Bloc`
ู `Cubit` ุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ ูุนุงููุงุช `BlocBuilder` ู `BlocConsumer` ู
`BlocListener` ูู `cubit` ุฅูู `bloc` ูุฃู ูุฐู ุงูุนูุงุตุฑ ุชุนูู ุนูู ููุน `BlocBase`.
ููุง ุฃู ูุฐุง ูุชูุงุดู ุจุดูู ุฃูุจุฑ ูุน ุงุณู ุงูููุชุจุฉ ููุฃูู ุฃู ูุญุณู ูู ูุงุจููุฉ ุงููุฑุงุกุฉ.

##### ููุฎุต

**v6.1.x**

```dart
BlocBuilder(
  cubit: myBloc,
  ...
)

BlocListener(
  cubit: myBloc,
  ...
)

BlocConsumer(
  cubit: myBloc,
  ...
)
```

**v7.0.0**

```dart
BlocBuilder(
  bloc: myBloc,
  ...
)

BlocListener(
  bloc: myBloc,
  ...
)

BlocConsumer(
  bloc: myBloc,
  ...
)
```

### `package:hydrated_bloc`

#### โ `storageDirectory` ูุทููุจ ุนูุฏ ุงุณุชุฏุนุงุก `HydratedStorage.build`

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ุฃุฌู ุฌุนู `package:hydrated_bloc` ุญุฒูุฉ Dart ุตุฑูุฉุ ุชูุช ุฅุฒุงูุฉ ุงูุงุนุชูุงุฏ ุนูู
[package:path_provider](https://pub.dev/packages/path_provider) ูุฃุตุจุญ ูุนุงูู
`storageDirectory` ุนูุฏ ุงุณุชุฏุนุงุก `HydratedStorage.build` ูุทููุจุงู ููู ูุนุฏ ูุนูุฏ
ุงูุชุฑุงุถูุงู ุฅูู `getTemporaryDirectory`.

##### ููุฎุต

**v6.x.x**

```dart
HydratedBloc.storage = await HydratedStorage.build();
```

**v7.0.0**

```dart
import 'package:path_provider/path_provider.dart';

...

HydratedBloc.storage = await HydratedStorage.build(
  storageDirectory: await getTemporaryDirectory(),
);
```

## v6.1.0

### `package:flutter_bloc`

#### โ ูุถุน ุนูุงูุฉ "ููุฌูุฑ" ุนูู `context.bloc` ู `context.repository` ูุตุงูุญ `context.read` ู `context.watch`

##### ุงูุฃุณุจุงุจ (Rationale)

ุชูุช ุฅุถุงูุฉ `context.read` ู `context.watch` ู `context.select` ูุชุชูุงุดู ูุน ูุงุฌูุฉ
ุจุฑูุฌุฉ ุชุทุจููุงุช [provider](https://pub.dev/packages/provider) ุงูุญุงููุฉ ุงูุชู ูุฃูููุง
ุงูุนุฏูุฏ ูู ุงููุทูุฑูู ููููุนุงูุฌุฉ ุงููุดููุงุช ุงูุชู ุฃุซุงุฑูุง ุงููุฌุชูุน. ูุชุญุณูู ุฃูุงู ุงูููุฏ
ูุงูุญูุงุธ ุนูู ุงูุงุชุณุงูุ ุชู ูุถุน ุนูุงูุฉ "ููุฌูุฑ" ุนูู `context.bloc` ูุฃูู ูููู ุงุณุชุจุฏุงูู
ุจู `context.read` ุฃู `context.watch` ุงุนุชูุงุฏุงู ุนูู ูุง ุฅุฐุง ูุงู ูุชู ุงุณุชุฎุฏุงูู ูุจุงุดุฑุฉ
ุฏุงุฎู `build`.

**context.watch**

ูุนุงูุฌ `context.watch` ุทูุจ ุงูุญุตูู ุนูู
[MultiBlocBuilder](https://github.com/felangel/bloc/issues/538) ูุฃูู ูููููุง
ูุฑุงูุจุฉ ุนุฏุฉ blocs ุฏุงุฎู `Builder` ูุงุญุฏ ูู ุฃุฌู ุนุฑุถ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจูุงุกู ุนูู ุญุงูุงุช
ูุชุนุฏุฏุฉ:

```dart
Builder(
  builder: (context) {
    final stateA = context.watch<BlocA>().state;
    final stateB = context.watch<BlocB>().state;
    final stateC = context.watch<BlocC>().state;

    // ุฅุฑุฌุงุน Widget ูุนุชูุฏ ุนูู ุญุงูุฉ BlocA ู BlocB ู BlocC
  }
);
```

**context.select**

ูุณูุญ `context.select` ูููุทูุฑูู ุจุนุฑุถ/ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจูุงุกู ุนูู ุฌุฒุก ูู ุญุงูุฉ
ุงูู bloc ููุนุงูุฌ ุทูุจ ุงูุญุตูู ุนูู
[buildWhen ุฃุจุณุท](https://github.com/felangel/bloc/issues/1521).

```dart
final name = context.select((UserBloc bloc) => bloc.state.user.name);
```

ุชุณูุญ ููุง ุงููุทุนุฉ ุงูุจุฑูุฌูุฉ ุฃุนูุงู ุจุงููุตูู ุฅูู ุงูู widget ูุฅุนุงุฏุฉ ุจูุงุฆู ููุท ุนูุฏูุง
ูุชุบูุฑ ุงุณู ุงููุณุชุฎุฏู ุงูุญุงูู.

**context.read**

ุนูู ุงูุฑุบู ูู ุฃู `context.read` ูุจุฏู ูุทุงุจูุงู ูู `context.bloc` ุ ุฅูุง ุฃู ููุงู ุจุนุถ
ุงูุงุฎุชูุงูุงุช ุงูุฏูููุฉ ูููู ุงููุงูุฉ. ููุงููุง ูุณูุญ ูู ุจุงููุตูู ุฅูู bloc ุจุงุณุชุฎุฏุงู
`BuildContext` ููุง ูุคุฏูุงู ุฅูู ุฅุนุงุฏุฉ ุงูุจูุงุกุ ููุน ุฐููุ ูุง ูููู ุงุณุชุฏุนุงุก
`context.read` ูุจุงุดุฑุฉ ุฏุงุฎู ุทุฑููุฉ `build`. ููุงู ุณุจุจุงู ุฑุฆูุณูุงู ูุงุณุชุฎุฏุงู
`context.bloc` ุฏุงุฎู `build`:

1. **ูููุตูู ุฅูู ุญุงูุฉ ุงูู bloc**

```dart
@override
Widget build(BuildContext context) {
  final state = context.bloc<MyBloc>().state;
  return Text('$state');
}
```

ุงูุงุณุชุฎุฏุงู ุฃุนูุงู ุนุฑุถุฉ ููุฎุทุฃ ูุฃู ุนูุตุฑ ุงูู `Text` ูู ูุชู ุฅุนุงุฏุฉ ุจูุงุฆู ุฅุฐุง ุชุบูุฑุช ุญุงูุฉ
ุงูู bloc. ูู ูุฐุง ุงูุณููุงุฑููุ ูุฌุจ ุงุณุชุฎุฏุงู ุฅูุง `BlocBuilder` ุฃู `context.watch`.

```dart
@override
Widget build(BuildContext context) {
  final state = context.watch<MyBloc>().state;
  return Text('$state');
}
```

ุฃู

```dart
@override
Widget build(BuildContext context) {
  return BlocBuilder<MyBloc, MyState>(
    builder: (context, state) => Text('$state'),
  );
}
```

:::note

ุณูุคุฏู ุงุณุชุฎุฏุงู `context.watch` ูู ุฌุฐุฑ ุทุฑููุฉ `build` ุฅูู ุฅุนุงุฏุฉ ุจูุงุก ุงูู widget
ุจุงููุงูู ุนูุฏ ุชุบูุฑ ุญุงูุฉ ุงูู bloc. ุฅุฐุง ูู ุชูู ููุงู ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุจูุงุก ุงูู widget
ุจุงููุงููุ ูุงุณุชุฎุฏู ุฅูุง `BlocBuilder` ูุชุบููู ุงูุฃุฌุฒุงุก ุงูุชู ูุฌุจ ุฅุนุงุฏุฉ ุจูุงุฆูุงุ ุฃู
ุงุณุชุฎุฏู `Builder` ูุน `context.watch` ูุชุญุฏูุฏ ูุทุงู ุฅุนุงุฏุฉ ุงูุจูุงุกุ ุฃู ูู ุจุชูููู ุงูู
widget ุฅูู widgets ุฃุตุบุฑ.

:::

2. **ูููุตูู ุฅูู ุงูู bloc ุญุชู ูููู ุฅุถุงูุฉ ุญุฏุซ**

```dart
@override
Widget build(BuildContext context) {
  final bloc = context.bloc<MyBloc>();
  return ElevatedButton(
    onPressed: () => bloc.add(MyEvent()),
    ...
  )
}
```

ุงูุงุณุชุฎุฏุงู ุฃุนูุงู ุบูุฑ ูุนุงู ูุฃูู ูุคุฏู ุฅูู ุงูุจุญุซ ุนู ุงูู bloc ูู ูู ุนูููุฉ ุฅุนุงุฏุฉ ุจูุงุก
ุจูููุง ูุง ุชููู ููุงู ุญุงุฌุฉ ููู bloc ุฅูุง ุนูุฏูุง ูููุฑ ุงููุณุชุฎุฏู ุนูู ุงูู
`ElevatedButton`. ูู ูุฐุง ุงูุณููุงุฑููุ ููุถู ุงุณุชุฎุฏุงู `context.read` ูููุตูู ุฅูู ุงูู
bloc ูุจุงุดุฑุฉ ุญูุซ ุชุจุฑุฒ ุงูุญุงุฌุฉ ุฅููู (ูู ูุฐู ุงูุญุงูุฉุ ูู ุงุณุชุฏุนุงุก `onPressed`).

```dart
@override
Widget build(BuildContext context) {
  return ElevatedButton(
    onPressed: () => context.read<MyBloc>().add(MyEvent()),
    ...
  )
}
```

##### ููุฎุต

**v6.0.x**

```dart
@override
Widget build(BuildContext context) {
  final bloc = context.bloc<MyBloc>();
  return ElevatedButton(
    onPressed: () => bloc.add(MyEvent()),
    ...
  )
}
```

**v6.1.x**

```dart
@override
Widget build(BuildContext context) {
  return ElevatedButton(
    onPressed: () => context.read<MyBloc>().add(MyEvent()),
    ...
  )
}
```

?> ุฅุฐุง ููุช ุชุตู ุฅูู bloc ูุฅุถุงูุฉ ุญุฏุซุ ููู ุจุงููุตูู ุฅููู ุจุงุณุชุฎุฏุงู `context.read` ูู
ุงูุงุณุชุฏุนุงุก (callback) ุญูุซ ุชุจุฑุฒ ุงูุญุงุฌุฉ ุฅููู.

**v6.0.x**

```dart
@override
Widget build(BuildContext context) {
  final state = context.bloc<MyBloc>().state;
  return Text('$state');
}
```

**v6.1.x**

```dart
@override
Widget build(BuildContext context) {
  final state = context.watch<MyBloc>().state;
  return Text('$state');
}
```

?> ุงุณุชุฎุฏู `context.watch` ุนูุฏ ุงููุตูู ุฅูู ุญุงูุฉ ุงูู bloc ูุถูุงู ุฅุนุงุฏุฉ ุจูุงุก ุงูู
widget ุนูุฏ ุชุบูุฑ ุงูุญุงูุฉ.

## v6.0.0

### `package:bloc`

#### โ `BlocObserver.onError` ูุฃุฎุฐ `Cubit`

##### ุงูุฃุณุจุงุจ (Rationale)

ุจุณุจุจ ุฏูุฌ `Cubit` ุ ุฃุตุจุญุช `onError` ุงูุขู ูุดุชุฑูุฉ ุจูู ูู ูู ูุซููุงุช `Bloc` ู
`Cubit`. ูุจูุง ุฃู `Cubit` ูู ุงููุงุนุฏุฉุ ูุฅู `BlocObserver` ุณููุจู ููุน `Cubit` ุจุฏูุงู
ูู ููุน `Bloc` ูู ุชุฌุงูุฒ `onError`.

**v5.x.x**

```dart
class MyBlocObserver extends BlocObserver {
  @override
  void onError(Bloc bloc, Object error, StackTrace stackTrace) {
    super.onError(bloc, error, stackTrace);
  }
}
```

**v6.0.0**

```dart
class MyBlocObserver extends BlocObserver {
  @override
  void onError(Cubit cubit, Object error, StackTrace stackTrace) {
    super.onError(cubit, error, stackTrace);
  }
}
```

#### โ ุงูู Bloc ูุง ูุฑุณู ุงูุญุงูุฉ ุงูุฃุฎูุฑุฉ ุนูุฏ ุงูุงุดุชุฑุงู

##### ุงูุฃุณุจุงุจ (Rationale)

ุชู ุฅุฌุฑุงุก ูุฐุง ุงูุชุบููุฑ ูููุงุกูุฉ `Bloc` ู `Cubit` ูุน ุณููู ุงูู `Stream` ุงููุฏูุฌ ูู
`Dart`. ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ุฃุฏู ุงูุงูุชุฒุงู ุจุงูุณููู ุงููุฏูู ูู ุณูุงู `Cubit` ุฅูู ุงูุนุฏูุฏ
ูู ุงูุขุซุงุฑ ุงูุฌุงูุจูุฉ ุบูุฑ ุงูููุตูุฏุฉ ูุนูุฏ ุจุดูู ุนุงู ุงูุชุทุจููุงุช ุงูุฏุงุฎููุฉ ููุญุฒู ุงูุฃุฎุฑู
ูุซู `flutter_bloc` ู `bloc_test` ุฏูู ุฏุงุนู (ููุง ุชุทูุจ ุงุณุชุฎุฏุงู `skip(1)` ุ ุฅูุฎ...).

**v5.x.x**

```dart
final bloc = MyBloc();
bloc.listen(print);
```

ุณุงุจูุงูุ ูุงูุช ุงููุทุนุฉ ุงูุจุฑูุฌูุฉ ุฃุนูุงู ุชุทุจุน ุงูุญุงูุฉ ุงูุฃูููุฉ ููู bloc ูุชุจูุนุฉ ุจุชุบููุฑุงุช
ุงูุญุงูุฉ ุงููุงุญูุฉ.

**v6.x.x**

ูู v6.0.0ุ ูุง ุชุทุจุน ุงููุทุนุฉ ุงูุจุฑูุฌูุฉ ุฃุนูุงู ุงูุญุงูุฉ ุงูุฃูููุฉ ูุชุทุจุน ููุท ุชุบููุฑุงุช ุงูุญุงูุฉ
ุงููุงุญูุฉ. ูููู ุชุญููู ุงูุณููู ุงูุณุงุจู ุจูุง ููู:

```dart
final bloc = MyBloc();
print(bloc.state);
bloc.listen(print);
```

?> **ููุงุญุธุฉ**: ุณูุคุซุฑ ูุฐุง ุงูุชุบููุฑ ููุท ุนูู ุงูููุฏ ุงูุฐู ูุนุชูุฏ ุนูู ุงุดุชุฑุงูุงุช bloc
ุงููุจุงุดุฑุฉ. ุนูุฏ ุงุณุชุฎุฏุงู `BlocBuilder` ุฃู `BlocListener` ุฃู `BlocConsumer` ุ ูู
ูููู ููุงู ุชุบููุฑ ููุญูุธ ูู ุงูุณููู.

### `package:bloc_test`

#### โ `MockBloc` ูุชุทูุจ ููุน ุงูุญุงูุฉ (State) ููุท

##### ุงูุฃุณุจุงุจ (Rationale)

ูุฐุง ููุณ ุถุฑูุฑูุงู ููุฒูู ุงูููุฏ ุงูุฒุงุฆุฏ ูุน ุฌุนู `MockBloc` ูุชูุงููุงู ูุน `Cubit`.

**v5.x.x**

```dart
class MockCounterBloc extends MockBloc<CounterEvent, int> implements CounterBloc {}
```

**v6.0.0**

```dart
class MockCounterBloc extends MockBloc<int> implements CounterBloc {}
```

#### โ `whenListen` ูุชุทูุจ ููุน ุงูุญุงูุฉ (State) ููุท

##### ุงูุฃุณุจุงุจ (Rationale)

ูุฐุง ููุณ ุถุฑูุฑูุงู ููุฒูู ุงูููุฏ ุงูุฒุงุฆุฏ ูุน ุฌุนู `whenListen` ูุชูุงููุงู ูุน `Cubit`.

**v5.x.x**

```dart
whenListen<CounterEvent,int>(bloc, Stream.fromIterable([0, 1, 2, 3]));
```

**v6.0.0**

```dart
whenListen<int>(bloc, Stream.fromIterable([0, 1, 2, 3]));
```

#### โ `blocTest` ูุง ูุชุทูุจ ููุน ุงูุญุฏุซ (Event)

##### ุงูุฃุณุจุงุจ (Rationale)

ูุฐุง ููุณ ุถุฑูุฑูุงู ููุฒูู ุงูููุฏ ุงูุฒุงุฆุฏ ูุน ุฌุนู `blocTest` ูุชูุงููุงู ูุน `Cubit`.

**v5.x.x**

```dart
blocTest<CounterBloc, CounterEvent, int>(
  'emits [1] when increment is called',
  build: () async => CounterBloc(),
  act: (bloc) => bloc.add(CounterEvent.increment),
  expect: const <int>[1],
);
```

**v6.0.0**

```dart
blocTest<CounterBloc, int>(
  'emits [1] when increment is called',
  build: () => CounterBloc(),
  act: (bloc) => bloc.add(CounterEvent.increment),
  expect: const <int>[1],
);
```

#### โ ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ูู `skip` ูู `blocTest` ูู 0

##### ุงูุฃุณุจุงุจ (Rationale)

ุจูุง ุฃู ูุซููุงุช `bloc` ู `cubit` ูู ุชุฑุณู ุงูุญุงูุฉ ุงูุฃุฎูุฑุฉ ููุงุดุชุฑุงูุงุช ุงูุฌุฏูุฏุฉุ ูู ูุนุฏ
ูู ุงูุถุฑูุฑู ุฌุนู ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ูู `skip` ูู `1`.

**v5.x.x**

```dart
blocTest<CounterBloc, CounterEvent, int>(
  'emits [0] when skip is 0',
  build: () async => CounterBloc(),
  skip: 0,
  expect: const <int>[0],
);
```

**v6.0.0**

```dart
blocTest<CounterBloc, int>(
  'emits [] when skip is 0',
  build: () => CounterBloc(),
  skip: 0,
  expect: const <int>[],
);
```

ูููู ุงุฎุชุจุงุฑ ุงูุญุงูุฉ ุงูุฃูููุฉ ูู bloc ุฃู cubit ุจูุง ููู:

```dart
test('initial state is correct', () {
  expect(MyBloc().state, InitialState());
});
```

#### โ ุฌุนู `build` ูู `blocTest` ูุชุฒุงููุงู (synchronous)

##### ุงูุฃุณุจุงุจ (Rationale)

ุณุงุจูุงูุ ุชู ุฌุนู `build` ุบูุฑ ูุชุฒุงูู (`async`) ุจุญูุซ ูููู ุฅุฌุฑุงุก ุชุญุถูุฑุงุช ูุชููุนุฉ ููุถุน
ุงูู bloc ุชุญุช ุงูุงุฎุชุจุงุฑ ูู ุญุงูุฉ ูุนููุฉ. ูู ูุนุฏ ูุฐุง ุถุฑูุฑูุงู ููุง ุฃูู ูุญู ุงูุนุฏูุฏ ูู
ุงููุดููุงุช ุงููุงุชุฌุฉ ุนู ุงูุชุฃุฎูุฑ ุงููุถุงู ุจูู ุงูุจูุงุก ูุงูุงุดุชุฑุงู ุฏุงุฎููุงู. ุจุฏูุงู ูู ุฅุฌุฑุงุก
ุชุญุถูุฑ ุบูุฑ ูุชุฒุงูู ููุถุน bloc ูู ุญุงูุฉ ูุทููุจุฉุ ูููููุง ุงูุขู ุชุนููู ุญุงูุฉ ุงูู bloc ุนู
ุทุฑูู ุฑุจุท `emit` ุจุงูุญุงูุฉ ุงููุทููุจุฉ.

**v5.x.x**

```dart
blocTest<CounterBloc, CounterEvent, int>(
  'emits [2] when increment is added',
  build: () async {
    final bloc = CounterBloc();
    bloc.add(CounterEvent.increment);
    await bloc.take(2);
    return bloc;
  }
  act: (bloc) => bloc.add(CounterEvent.increment),
  expect: const <int>[2],
);
```

**v6.0.0**

```dart
blocTest<CounterBloc, int>(
  'emits [2] when increment is added',
  build: () => CounterBloc()..emit(1),
  act: (bloc) => bloc.add(CounterEvent.increment),
  expect: const <int>[2],
);
```

:::note

`emit` ูุฑุฆู ููุท ููุงุฎุชุจุงุฑ ููุง ููุจุบู ุงุณุชุฎุฏุงูู ุฃุจุฏุงู ุฎุงุฑุฌ ุงูุงุฎุชุจุงุฑุงุช.

:::

### `package:flutter_bloc`

#### โ ุฅุนุงุฏุฉ ุชุณููุฉ ูุนุงูู `bloc` ูู `BlocBuilder` ุฅูู `cubit`

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ุฃุฌู ุฌุนู `BlocBuilder` ูุนูู ูุน ูุซููุงุช `bloc` ู `cubit` ุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ ูุนุงูู
`bloc` ุฅูู `cubit` (ุจูุง ุฃู `Cubit` ูู ุงููุฆุฉ ุงูุฃุณุงุณูุฉ).

**v5.x.x**

```dart
BlocBuilder(
  bloc: myBloc,
  builder: (context, state) {...}
)
```

**v6.0.0**

```dart
BlocBuilder(
  cubit: myBloc,
  builder: (context, state) {...}
)
```

#### โ ุฅุนุงุฏุฉ ุชุณููุฉ ูุนุงูู `bloc` ูู `BlocListener` ุฅูู `cubit`

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ุฃุฌู ุฌุนู `BlocListener` ูุนูู ูุน ูุซููุงุช `bloc` ู `cubit` ุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ
ูุนุงูู `bloc` ุฅูู `cubit` (ุจูุง ุฃู `Cubit` ูู ุงููุฆุฉ ุงูุฃุณุงุณูุฉ).

**v5.x.x**

```dart
BlocListener(
  bloc: myBloc,
  listener: (context, state) {...}
)
```

**v6.0.0**

```dart
BlocListener(
  cubit: myBloc,
  listener: (context, state) {...}
)
```

#### โ ุฅุนุงุฏุฉ ุชุณููุฉ ูุนุงูู `bloc` ูู `BlocConsumer` ุฅูู `cubit`

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ุฃุฌู ุฌุนู `BlocConsumer` ูุนูู ูุน ูุซููุงุช `bloc` ู `cubit` ุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ
ูุนุงูู `bloc` ุฅูู `cubit` (ุจูุง ุฃู `Cubit` ูู ุงููุฆุฉ ุงูุฃุณุงุณูุฉ).

**v5.x.x**

```
BlocConsumer(
  cubit: myBloc,
  listener: (context, state) {...},
  builder: (context, state) {...}
)
```

**v6.0.0**

```dart
BlocConsumer(
  cubit: myBloc,
  listener: (context, state) {...},
  builder: (context, state) {...}
)
```

---

## v5.0.0

### `package:bloc`

#### โ ุฅุฒุงูุฉ `initialState`

##### ุงูุฃุณุจุงุจ (Rationale)

ููุทูุฑุ ูุงู ุงูุงุถุทุฑุงุฑ ุฅูู ุชุฌุงูุฒ `initialState` ุนูุฏ ุฅูุดุงุก bloc ููุซู ูุดููุชูู
ุฑุฆูุณูุชูู:

- ูููู ุฃู ุชููู ุงูู `initialState` ููู bloc ุฏููุงููููุฉ ููููู ุฃูุถุงู ุงูุฑุฌูุน ุฅูููุง ูู
  ููุช ูุงุญู (ุญุชู ุฎุงุฑุฌ ุงูู bloc ููุณู). ุจุทุฑููุฉ ูุงุ ูููู ุงุนุชุจุงุฑ ุฐูู ุชุณุฑูุจุงู ููุนูููุงุช
  ุงูู bloc ุงูุฏุงุฎููุฉ ุฅูู ุทุจูุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู.
- ุฅููุง ุทุฑููุฉ ูุทููุฉ (verbose).

**v4.x.x**

```dart
class CounterBloc extends Bloc<CounterEvent, int> {
  @override
  int get initialState => 0;

  ...
}
```

**v5.0.0**

```dart
class CounterBloc extends Bloc<CounterEvent, int> {
  CounterBloc() : super(0);

  ...
}
```

?> ููุฒูุฏ ูู ุงููุนูููุงุชุ ุฑุงุฌุน
[#1304](https://github.com/felangel/bloc/issues/1304)

#### โ ุฅุนุงุฏุฉ ุชุณููุฉ `BlocDelegate` ุฅูู `BlocObserver`

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ููู ุงุณู `BlocDelegate` ูุตูุงู ุฏูููุงู ููุฏูุฑ ุงูุฐู ุชูุนุจู ุงููุฆุฉ. ููุญู ุงุณู
`BlocDelegate` ุจุฃู ุงููุฆุฉ ุชูุนุจ ุฏูุฑุงู ูุดุทุงูุ ุจูููุง ูู ุงููุงูุน ูุงู ุงูุฏูุฑ ุงูููุตูุฏ ูู
`BlocDelegate` ูู ุฃู ูููู ููููุงู ุณูุจูุงู ูุฑุงูุจ ุจุจุณุงุทุฉ ุฌููุน ุงูู blocs ูู ุงูุชุทุจูู.

:::note

ูู ุงููุงุญูุฉ ุงููุซุงููุฉุ ูุง ููุจุบู ุงูุชุนุงูู ูุน ุฃู ูุธุงุฆู ุฃู ููุฒุงุช ููุฌูุฉ ูููุณุชุฎุฏู ุฏุงุฎู
`BlocObserver`.

:::

**v4.x.x**

```dart
class MyBlocDelegate extends BlocDelegate {
  ...
}
```

**v5.0.0**

```dart
class MyBlocObserver extends BlocObserver {
  ...
}
```

#### โ ุฅุฒุงูุฉ `BlocSupervisor`

##### ุงูุฃุณุจุงุจ (Rationale)

ูุงู `BlocSupervisor` ููููุงู ุขุฎุฑ ูุชุนูู ุนูู ุงููุทูุฑูู ูุนุฑูุชู ูุงูุชูุงุนู ูุนู ูุบุฑุถ ูุญูุฏ
ูู ุชุญุฏูุฏ `BlocDelegate` ูุฎุตุต. ูุน ุงูุชุบููุฑ ุฅูู `BlocObserver` ุ ุดุนุฑูุง ุฃูู ูู
ุงูุฃูุถู ูุชุฌุฑุจุฉ ุงููุทูุฑ ุชุนููู ุงููุฑุงูุจ ูุจุงุดุฑุฉ ุนูู ุงูู bloc ููุณู.

?> ููููุง ูุฐุง ุงูุชุบููุฑ ุฃูุถุงู ูู ูุตู ุฅุถุงูุงุช bloc ุงูุฃุฎุฑู ูุซู `HydratedStorage` ุนู
ุงูู `BlocObserver`.

**v4.x.x**

```dart
BlocSupervisor.delegate = MyBlocDelegate();
```

**v5.0.0**

```dart
Bloc.observer = MyBlocObserver();
```

### `package:flutter_bloc`

#### โ ุฅุนุงุฏุฉ ุชุณููุฉ `condition` ูู `BlocBuilder` ุฅูู `buildWhen`

##### ุงูุฃุณุจุงุจ (Rationale)

ุนูุฏ ุงุณุชุฎุฏุงู `BlocBuilder` ุ ูุงู ุจุฅููุงููุง ุณุงุจูุงู ุชุญุฏูุฏ `condition` ูุชุญุฏูุฏ ูุง ุฅุฐุง
ูุงู ูุฌุจ ุนูู ุงูู `builder` ุฅุนุงุฏุฉ ุงูุจูุงุก.

```dart
BlocBuilder<MyBloc, MyState>(
  condition: (previous, current) {
    // ุฅุฑุฌุงุน true/false ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุณูุชู ุงุณุชุฏุนุงุก ุงูู builder
  },
  builder: (context, state) {...}
)
```

ุงุณู `condition` ููุณ ูุงุถุญุงู ุฌุฏุงู ุฃู ุจุฏูููุงูุ ูุงูุฃูู ูู ุฐููุ ุนูุฏ ุงูุชูุงุนู ูุน
`BlocConsumer` ุ ุฃุตุจุญุช ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุบูุฑ ูุชุณูุฉ ูุฃู ุงููุทูุฑูู ูููููู ุชูุฏูู
ุดุฑุทูู (ูุงุญุฏ ููู `builder` ููุงุญุฏ ููู `listener`). ููุชูุฌุฉ ูุฐููุ ูุดู API ุงูู
`BlocConsumer` ุนู `buildWhen` ู `listenWhen`.

```dart
BlocConsumer<MyBloc, MyState>(
  listenWhen: (previous, current) {
    // ุฅุฑุฌุงุน true/false ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุณูุชู ุงุณุชุฏุนุงุก ุงูู listener
  },
  listener: (context, state) {...},
  buildWhen: (previous, current) {
    // ุฅุฑุฌุงุน true/false ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุณูุชู ุงุณุชุฏุนุงุก ุงูู builder
  },
  builder: (context, state) {...},
)
```

ูู ุฃุฌู ููุงุกูุฉ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุชูููุฑ ุชุฌุฑุจุฉ ูุทูุฑ ุฃูุซุฑ ุงุชุณุงูุงูุ ุชูุช ุฅุนุงุฏุฉ
ุชุณููุฉ `condition` ุฅูู `buildWhen`.

**v4.x.x**

```dart
BlocBuilder<MyBloc, MyState>(
  condition: (previous, current) {
    // ุฅุฑุฌุงุน true/false ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุณูุชู ุงุณุชุฏุนุงุก ุงูู builder
  },
  builder: (context, state) {...}
)
```

**v5.0.0**

```dart
BlocBuilder<MyBloc, MyState>(
  buildWhen: (previous, current) {
    // ุฅุฑุฌุงุน true/false ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุณูุชู ุงุณุชุฏุนุงุก ุงูู builder
  },
  builder: (context, state) {...}
)
```

#### โ ุฅุนุงุฏุฉ ุชุณููุฉ `condition` ูู `BlocListener` ุฅูู `listenWhen`

##### ุงูุฃุณุจุงุจ (Rationale)

ูููุณ ุงูุฃุณุจุงุจ ุงููุฐููุฑุฉ ุฃุนูุงูุ ุชูุช ุฃูุถุงู ุฅุนุงุฏุฉ ุชุณููุฉ ุดุฑุท `BlocListener`.

**v4.x.x**

```dart
BlocListener<MyBloc, MyState>(
  condition: (previous, current) {
    // ุฅุฑุฌุงุน true/false ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุณูุชู ุงุณุชุฏุนุงุก ุงูู listener
  },
  listener: (context, state) {...}
)
```

**v5.0.0**

```dart
BlocListener<MyBloc, MyState>(
  listenWhen: (previous, current) {
    // ุฅุฑุฌุงุน true/false ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุณูุชู ุงุณุชุฏุนุงุก ุงูู listener
  },
  listener: (context, state) {...}
)
```

### `package:hydrated_bloc`

#### โ ุฅุนุงุฏุฉ ุชุณููุฉ `HydratedStorage` ู `HydratedBlocStorage`

##### ุงูุฃุณุจุงุจ (Rationale)

ูู ุฃุฌู ุชุญุณูู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูููุฏ ุจูู
[hydrated_bloc](https://pub.dev/packages/hydrated_bloc) ู
[hydrated_cubit](https://pub.dev/packages/hydrated_cubit) ุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ
ุชุทุจูู ุงูุชุฎุฒูู ุงูุงูุชุฑุงุถู ุงููุนูู ูู `HydratedBlocStorage` ุฅูู `HydratedStorage`.
ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ ูุงุฌูุฉ `HydratedStorage` ูู `HydratedStorage`
ุฅูู `Storage`.

**v4.0.0**

```dart
class MyHydratedStorage implements HydratedStorage {
  ...
}
```

**v5.0.0**

```dart
class MyHydratedStorage implements Storage {
  ...
}
```

#### โ ูุตู `HydratedStorage` ุนู `BlocDelegate`

##### ุงูุฃุณุจุงุจ (Rationale)

ููุง ุฐูุฑูุง ุณุงุจูุงูุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ `BlocDelegate` ุฅูู `BlocObserver` ูุชู ุชุนูููู
ูุจุงุดุฑุฉ ูุฌุฒุก ูู ุงูู `bloc` ุนุจุฑ:

```dart
Bloc.observer = MyBlocObserver();
```

ุชู ุฅุฌุฑุงุก ุงูุชุบููุฑ ุงูุชุงูู ูู ุฃุฌู:

- ุงูุจูุงุก ูุชุณูุงู ูุน API ูุฑุงูุจ bloc ุงูุฌุฏูุฏ.
- ุฅุจูุงุก ุงูุชุฎุฒูู ูุญุตูุฑุงู ูู `HydratedBloc` ููุท.
- ูุตู ุงูู `BlocObserver` ุนู ุงูู `Storage`.

**v4.0.0**

```dart
BlocSupervisor.delegate = await HydratedBlocDelegate.build();
```

**v5.0.0**

```dart
HydratedBloc.storage = await HydratedStorage.build();
```

#### โ ุชุจุณูุท ุนูููุฉ ุงูุชููุฆุฉ (Initialization)

##### ุงูุฃุณุจุงุจ (Rationale)

ุณุงุจูุงูุ ูุงู ุนูู ุงููุทูุฑูู ุงุณุชุฏุนุงุก `super.initialState ?? DefaultInitialState()`
ูุฏููุงู ูู ุฃุฌู ุฅุนุฏุงุฏ ูุซููุงุช `HydratedBloc` ุงูุฎุงุตุฉ ุจูู. ูุงู ูุฐุง ุงูุฃูุฑ ุซูููุงู
ููุทููุงู ูุบูุฑ ูุชูุงูู ุฃูุถุงู ูุน ุงูุชุบููุฑุงุช ุงูุฌุฐุฑูุฉ ูู `initialState` ูู `bloc`.
ููุชูุฌุฉ ูุฐููุ ุฃุตุจุญุช ุชููุฆุฉ `HydratedBloc` ูู v5.0.0 ูุทุงุจูุฉ ูุชููุฆุฉ `Bloc` ุงูุนุงุฏูุฉ.

**v4.0.0**

```dart
class CounterBloc extends HydratedBloc<CounterEvent, int> {
  @override
  int get initialState => super.initialState ?? 0;
}
```

**v5.0.0**

```dart
class CounterBloc extends HydratedBloc<CounterEvent, int> {
  CounterBloc() : super(0);

  ...
}
```
