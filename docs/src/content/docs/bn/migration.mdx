---
title: ‡¶Æ‡¶æ‡¶á‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ó‡¶æ‡¶á‡¶°
description: Bloc-‡¶è‡¶∞ ‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ stable ‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶®‡ßá ‡¶Æ‡¶æ‡¶á‡¶ó‡ßç‡¶∞‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
---

import { Code, Tabs, TabItem } from '@astrojs/starlight/components';

:::tip

‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø release-‡¶è ‡¶ï‡ßÄ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶∏‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá ‡¶Ü‡¶∞‡¶ì ‡¶§‡¶•‡ßç‡¶Ø‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
[release log](https://github.com/felangel/bloc/releases) ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®‡•§

:::

## v10.0.0

### `package:bloc_test`

#### ‚ùó‚ú® `blocTest`-‡¶ï‡ßá `BlocBase` ‡¶•‡ßá‡¶ï‡ßá Decouple ‡¶ï‡¶∞‡¶æ

:::note[What Changed?]

bloc_test v10.0.0-‡¶è, `blocTest` API ‡¶Ü‡¶∞ `BlocBase`-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá tightly coupled ‡¶®‡ßá‡¶á‡•§

:::

##### Rationale

`blocTest`-‡¶è‡¶∞ ‡¶â‡¶ö‡¶ø‡¶§ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶π‡¶≤‡ßá core bloc interfaces ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ flexibility ‡¶è‡¶¨‡¶Ç
reusability ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ‡¶Ü‡¶ó‡ßá ‡¶è‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶õ‡¶ø‡¶≤ ‡¶®‡¶æ ‡¶ï‡¶æ‡¶∞‡¶£ `BlocBase`
`StateStreamableSource` implement ‡¶ï‡¶∞‡¶§ ‡¶Ø‡¶æ `blocTest`-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡¶•‡ßá‡¶∑‡ßç‡¶ü ‡¶õ‡¶ø‡¶≤ ‡¶®‡¶æ `emit`
API-‡¶è‡¶∞ ‡¶â‡¶™‡¶∞ internal dependency-‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá‡•§

### `package:hydrated_bloc`

#### ‚ùó‚ú® WebAssembly ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü

:::note[What Changed?]

hydrated_bloc v10.0.0-‡¶è, WebAssembly (wasm)-‡¶è compile ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ
‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§

:::

##### Rationale

‡¶Ü‡¶ó‡ßá `hydrated_bloc` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º apps-‡¶ï‡ßá wasm-‡¶è compile ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶õ‡¶ø‡¶≤ ‡¶®‡¶æ‡•§
v10.0.0-‡¶è, ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú‡¶ü‡¶ø refactor ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá wasm-‡¶è compile ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶§‡¶ø ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞
‡¶ú‡¶®‡ßç‡¶Ø‡•§

**v9.x.x**

```dart
Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  HydratedBloc.storage = await HydratedStorage.build(
    storageDirectory: kIsWeb
        ? HydratedStorage.webStorageDirectory
        : await getTemporaryDirectory(),
  );
  runApp(App());
}
```

**v10.x.x**

```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  HydratedBloc.storage = await HydratedStorage.build(
    storageDirectory: kIsWeb
        ? HydratedStorageDirectory.web
        : HydratedStorageDirectory((await getTemporaryDirectory()).path),
  );
  runApp(const App());
}
```

## v9.0.0

### `package:bloc`

#### ‚ùóüßπ Deprecated APIs ‡¶∏‡¶∞‡¶æ‡¶®‡ßã

:::note[What Changed?]

bloc v9.0.0-‡¶è, ‡¶Ü‡¶ó‡ßá ‡¶•‡ßá‡¶ï‡ßá deprecated ‡¶∏‡¶¨ APIs ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§

:::

##### Summary

- `BlocOverrides` ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `Bloc.observer` ‡¶è‡¶¨‡¶Ç `Bloc.transformer`-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá

#### ‚ùó‚ú® ‡¶®‡¶§‡ßÅ‡¶® `EmittableStateStreamableSource` Interface ‡¶ö‡¶æ‡¶≤‡ßÅ

:::note[What Changed?]

bloc v9.0.0-‡¶è, ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® core interface `EmittableStateStreamableSource` ‡¶ö‡¶æ‡¶≤‡ßÅ
‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§

:::

##### Rationale

`package:bloc_test` ‡¶Ü‡¶ó‡ßá `BlocBase`-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá tightly coupled ‡¶õ‡¶ø‡¶≤‡•§
`EmittableStateStreamableSource` interface ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ‡¶§‡ßá `blocTest`-‡¶ï‡ßá
`BlocBase` concrete implementation ‡¶•‡ßá‡¶ï‡ßá decouple ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§

### `package:hydrated_bloc`

#### ‚ú® `HydratedBloc.storage` API ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶ö‡¶æ‡¶≤‡ßÅ

:::note[What Changed?]

hydrated_bloc v9.0.0-‡¶è, `HydratedBlocOverrides` ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
`HydratedBloc.storage` API-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡•§\*\*

:::

##### Rationale

Bloc.observer ‡¶è‡¶¨‡¶Ç Bloc.transformer overrides ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ‡¶∞ rationale-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
[/migration#-reintroduce-blocobserver-and-bloctransformer-apis](/migration#-reintroduce-blocobserver-and-bloctransformer-apis)‡•§

**v8.x.x**

```dart
Future<void> main() async {
  final storage = await HydratedStorage.build(
    storageDirectory: kIsWeb
        ? HydratedStorage.webStorageDirectory
        : await getTemporaryDirectory(),
  );
  HydratedBlocOverrides.runZoned(
    () => runApp(App()),
    storage: storage,
  );
}
```

**v9.0.0**

```dart
Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  HydratedBloc.storage = await HydratedStorage.build(
    storageDirectory: kIsWeb
        ? HydratedStorage.webStorageDirectory
        : await getTemporaryDirectory(),
  );
  runApp(App());
}
```

## v8.1.0

### `package:bloc`

#### ‚ú® `Bloc.observer` ‡¶è‡¶¨‡¶Ç `Bloc.transformer` APIs ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶ö‡¶æ‡¶≤‡ßÅ

:::note[What Changed?]

bloc v8.1.0-‡¶è, `BlocOverrides` deprecated ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `Bloc.observer` ‡¶è‡¶¨‡¶Ç
`Bloc.transformer` APIs-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡•§

:::

##### Rationale

`BlocOverrides` API v8.0.0-‡¶è ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤ `BlocObserver`,
`EventTransformer`, ‡¶è‡¶¨‡¶Ç `HydratedStorage`-‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã bloc-specific configurations
scope ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ‡¶Ø‡¶º‡•§ Pure Dart applications-‡¶è, ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤;
‡¶§‡¶¨‡ßá, Flutter applications-‡¶è ‡¶®‡¶§‡ßÅ‡¶® API ‡¶Ø‡¶§‡¶ü‡¶æ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡ßá ‡¶§‡¶æ‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡ßá‡¶∂‡¶ø
‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡•§

`BlocOverrides` API Flutter/Dart-‡¶è ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßÇ‡¶™ APIs ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶™‡ßç‡¶∞‡¶æ‡¶£‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤:

- [HttpOverrides](https://api.flutter.dev/flutter/dart-io/HttpOverrides-class.html)
- [IOOverrides](https://api.flutter.dev/flutter/dart-io/IOOverrides-class.html)

**‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ**

‡¶Ø‡¶¶‡¶ø‡¶ì ‡¶è‡¶ü‡¶ø ‡¶è‡¶á ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶õ‡¶ø‡¶≤ ‡¶®‡¶æ, `BlocOverrides` API ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞
‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ complexity ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶è‡¶∏‡ßá‡¶õ‡ßá‡•§ ‡¶è‡¶ï‡¶á ‡¶™‡ßç‡¶∞‡¶≠‡¶æ‡¶¨ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º
nesting ‡¶è‡¶¨‡¶Ç code-‡¶è‡¶∞ ‡¶≤‡¶æ‡¶á‡¶®‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶®‡ßã‡¶∞ ‡¶™‡¶æ‡¶∂‡¶æ‡¶™‡¶æ‡¶∂‡¶ø, `BlocOverrides` API-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ Dart-‡¶è
[Zones](https://api.dart.dev/stable/2.17.6/dart-async/Zone-class.html)-‡¶è‡¶∞ ‡¶â‡¶™‡¶∞
solid understanding ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤‡•§ `Zones` beginner-friendly ‡¶ß‡¶æ‡¶∞‡¶£‡¶æ ‡¶®‡¶Ø‡¶º ‡¶è‡¶¨‡¶Ç Zones
‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá ‡¶§‡¶æ ‡¶¨‡ßÅ‡¶ù‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡¶§‡¶æ bugs (‡¶Ø‡ßá‡¶Æ‡¶® uninitialized observers,
transformers, storage instances) ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§

‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£‡¶∏‡ßç‡¶¨‡¶∞‡ßÇ‡¶™, ‡¶Ö‡¶®‡ßá‡¶ï ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡ßá‡¶∞ ‡¶è‡¶Æ‡¶® ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶•‡¶æ‡¶ï‡¶§:

```dart
void main() {
  WidgetsFlutterBinding.ensureInitialized();
  BlocOverrides.runZoned(...);
}
```

‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶°, ‡¶Ø‡¶¶‡¶ø‡¶ì harmless ‡¶Æ‡¶®‡ßá ‡¶π‡¶Ø‡¶º, ‡¶Ü‡¶∏‡¶≤‡ßá ‡¶Ö‡¶®‡ßá‡¶ï track ‡¶ï‡¶∞‡¶æ ‡¶ï‡¶†‡¶ø‡¶® bugs ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§
`WidgetsFlutterBinding.ensureInitialized` ‡¶Ø‡ßá zone ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ï‡¶≤ ‡¶π‡¶Ø‡¶º ‡¶∏‡ßá‡¶ü‡¶ø‡¶á ‡¶π‡¶¨‡ßá
‡¶Ø‡ßá zone-‡¶è gesture events handle ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º (‡¶Ø‡ßá‡¶Æ‡¶® `onTap`, `onPressed` callbacks)
`GestureBinding.initInstances`-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá‡•§ ‡¶è‡¶ü‡¶ø `zoneValues` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶∏‡ßÉ‡¶∑‡ßç‡¶ü
‡¶Ö‡¶®‡ßá‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞‡•§

‡¶è‡¶õ‡¶æ‡¶°‡¶º‡¶æ‡¶ì, Flutter ‡¶Ö‡¶®‡ßá‡¶ï ‡¶ï‡¶ø‡¶õ‡ßÅ behind the scenes ‡¶ï‡¶∞‡ßá ‡¶Ø‡¶æ forking/manipulating
Zones-‡¶ï‡ßá ‡¶ú‡¶°‡¶º‡¶ø‡¶§ ‡¶ï‡¶∞‡ßá (‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡¶∞‡ßá tests ‡¶ö‡¶æ‡¶≤‡¶æ‡¶®‡ßã‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º) ‡¶Ø‡¶æ unexpected behaviors ‡¶§‡ßà‡¶∞‡¶ø
‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá (‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶®‡ßá‡¶ï ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá behaviors ‡¶Ø‡¶æ developer-‡¶è‡¶∞ ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá --
‡¶®‡¶ø‡¶ö‡ßá‡¶∞ issues ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®)‡•§

[runZoned](https://api.flutter.dev/flutter/dart-async/runZoned.html) ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞
‡¶ï‡¶æ‡¶∞‡¶£‡ßá, `BlocOverrides` API-‡¶§‡ßá transition Flutter-‡¶è ‡¶¨‡ßá‡¶∂ ‡¶ï‡¶Ø‡¶º‡ßá‡¶ï‡¶ü‡¶ø bugs/limitations
‡¶Ü‡¶¨‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞‡ßá‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ó‡ßá‡¶õ‡ßá (‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡¶∞‡ßá Widget ‡¶è‡¶¨‡¶Ç Integration Tests-‡¶è‡¶∞ ‡¶Ü‡¶∂‡ßá‡¶™‡¶æ‡¶∂‡ßá):

- https://github.com/flutter/flutter/issues/96939
- https://github.com/flutter/flutter/issues/94123
- https://github.com/flutter/flutter/issues/93676

‡¶Ø‡¶æ bloc library ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶Ö‡¶®‡ßá‡¶ï ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶ï‡ßá ‡¶™‡ßç‡¶∞‡¶≠‡¶æ‡¶¨‡¶ø‡¶§ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá:

- https://github.com/felangel/bloc/issues/3394
- https://github.com/felangel/bloc/issues/3350
- https://github.com/felangel/bloc/issues/3319

**v8.0.x**

```dart
void main() {
  BlocOverrides.runZoned(
    () {
      // ...
    },
    blocObserver: CustomBlocObserver(),
    eventTransformer: customEventTransformer(),
  );
}
```

**v8.1.0**

```dart
void main() {
  Bloc.observer = CustomBlocObserver();
  Bloc.transformer = customEventTransformer();

  // ...
}
```

## v8.0.0

### `package:bloc`

#### ‚ùó‚ú® ‡¶®‡¶§‡ßÅ‡¶® `BlocOverrides` API ‡¶ö‡¶æ‡¶≤‡ßÅ

:::note[What Changed?]

bloc v8.0.0-‡¶è, `Bloc.observer` ‡¶è‡¶¨‡¶Ç `Bloc.transformer` ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
`BlocOverrides` API-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡•§

:::

##### Rationale

‡¶Ü‡¶ó‡ßá‡¶∞ API ‡¶Ø‡¶æ default `BlocObserver` ‡¶è‡¶¨‡¶Ç `EventTransformer` override ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§
‡¶π‡¶§ `BlocObserver` ‡¶è‡¶¨‡¶Ç `EventTransformer` ‡¶â‡¶≠‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø global singleton-‡¶è‡¶∞
‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞ ‡¶ï‡¶∞‡¶§‡•§

‡¶´‡¶≤‡¶∏‡ßç‡¶¨‡¶∞‡ßÇ‡¶™, ‡¶è‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶õ‡¶ø‡¶≤ ‡¶®‡¶æ:

- Application-‡¶è‡¶∞ ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶Ö‡¶Ç‡¶∂‡ßá scoped ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï `BlocObserver` ‡¶¨‡¶æ `EventTransformer`
  implementations ‡¶•‡¶æ‡¶ï‡¶æ
- ‡¶è‡¶ï‡¶ü‡¶ø package-‡¶è scoped `BlocObserver` ‡¶¨‡¶æ `EventTransformer` overrides ‡¶•‡¶æ‡¶ï‡¶æ
  - ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø package `package:bloc`-‡¶è‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶∞ ‡¶®‡¶ø‡¶ú‡¶∏‡ßç‡¶¨
    `BlocObserver` register ‡¶ï‡¶∞‡ßá, package-‡¶è‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã consumer-‡¶ï‡ßá ‡¶π‡¶Ø‡¶º package-‡¶è‡¶∞
    `BlocObserver` overwrite ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶Ö‡¶•‡¶¨‡¶æ package-‡¶è‡¶∞ `BlocObserver`-‡¶è report
    ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§

Tests ‡¶ú‡ßÅ‡¶°‡¶º‡ßá shared global state-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá test ‡¶ï‡¶∞‡¶æ‡¶ì ‡¶Ü‡¶∞‡¶ì ‡¶ï‡¶†‡¶ø‡¶® ‡¶õ‡¶ø‡¶≤‡•§

Bloc v8.0.0 ‡¶è‡¶ï‡¶ü‡¶ø `BlocOverrides` class ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø specific
`Zone`-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø `BlocObserver` ‡¶è‡¶¨‡¶Ç/‡¶Ö‡¶•‡¶¨‡¶æ `EventTransformer` override ‡¶ï‡¶∞‡¶§‡ßá ‡¶¶‡ßá‡¶Ø‡¶º
global mutable singleton-‡¶è‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡ßá‡•§

**v7.x.x**

```dart
void main() {
  Bloc.observer = CustomBlocObserver();
  Bloc.transformer = customEventTransformer();

  // ...
}
```

**v8.0.0**

```dart
void main() {
  BlocOverrides.runZoned(
    () {
      // ...
    },
    blocObserver: CustomBlocObserver(),
    eventTransformer: customEventTransformer(),
  );
}
```

`Bloc` instances `BlocOverrides.current`-‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá current `Zone`-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
`BlocObserver` ‡¶è‡¶¨‡¶Ç/‡¶Ö‡¶•‡¶¨‡¶æ `EventTransformer` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡•§ ‡¶Ø‡¶¶‡¶ø zone-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã
`BlocOverrides` ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá ‡¶§‡¶æ‡¶∞‡¶æ existing internal defaults ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá
(behavior/functionality-‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶®‡ßá‡¶á)‡•§

‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø `Zone`-‡¶ï‡ßá ‡¶§‡¶æ‡¶∞ ‡¶®‡¶ø‡¶ú‡¶∏‡ßç‡¶¨ `BlocOverrides`-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶§‡ßá
‡¶¶‡ßá‡¶Ø‡¶º‡•§

```dart
BlocOverrides.runZoned(
  () {
    // BlocObserverA and eventTransformerA
    final overrides = BlocOverrides.current;

    // Blocs in this zone report to BlocObserverA
    // and use eventTransformerA as the default transformer.
    // ...

    // Later...
    BlocOverrides.runZoned(
      () {
        // BlocObserverB and eventTransformerB
        final overrides = BlocOverrides.current;

        // Blocs in this zone report to BlocObserverB
        // and use eventTransformerB as the default transformer.
        // ...
      },
      blocObserver: BlocObserverB(),
      eventTransformer: eventTransformerB(),
    );
  },
  blocObserver: BlocObserverA(),
  eventTransformer: eventTransformerA(),
);
```

#### ‚ùó‚ú® Error Handling ‡¶è‡¶¨‡¶Ç Reporting ‡¶â‡¶®‡ßç‡¶®‡¶§‡¶ø

:::note[What Changed?]

bloc v8.0.0-‡¶è, `BlocUnhandledErrorException` ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶è‡¶õ‡¶æ‡¶°‡¶º‡¶æ‡¶ì, ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã
uncaught exceptions ‡¶∏‡¶¨‡¶∏‡¶Æ‡¶Ø‡¶º `onError`-‡¶è report ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º ‡¶è‡¶¨‡¶Ç rethrown ‡¶π‡¶Ø‡¶º (debug ‡¶¨‡¶æ
release mode ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶ø‡¶∂‡ßá‡¶∑‡ßá)‡•§ `addError` API errors-‡¶ï‡ßá `onError`-‡¶è report ‡¶ï‡¶∞‡ßá,
‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ reported errors-‡¶ï‡ßá uncaught exceptions ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá treat ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ‡•§

:::

##### Rationale

‡¶è‡¶á ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶π‡¶≤:

- bloc functionality ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º internal unhandled exceptions ‡¶Ö‡¶§‡ßç‡¶Ø‡¶®‡ßç‡¶§
  ‡¶∏‡ßç‡¶™‡¶∑‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ
- control flow ‡¶¨‡¶ø‡¶ò‡ßç‡¶®‡¶ø‡¶§ ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá `addError` support ‡¶ï‡¶∞‡¶æ

‡¶Ü‡¶ó‡ßá, error handling ‡¶è‡¶¨‡¶Ç reporting application debug ‡¶¨‡¶æ release mode-‡¶è ‡¶ö‡¶≤‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ
‡¶§‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶π‡¶§‡•§ ‡¶è‡¶õ‡¶æ‡¶°‡¶º‡¶æ‡¶ì, `addError`-‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá reported errors
debug mode-‡¶è uncaught exceptions ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá treat ‡¶ï‡¶∞‡¶æ ‡¶π‡¶§ ‡¶Ø‡¶æ `addError` API ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞
‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶è‡¶ï‡¶ü‡¶ø poor developer experience ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤ (‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡¶∞‡ßá unit tests ‡¶≤‡ßá‡¶ñ‡¶æ‡¶∞
‡¶∏‡¶Æ‡¶Ø‡¶º)‡•§

v8.0.0-‡¶è, `addError` errors report ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç
`blocTest` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ø‡ßá errors report ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶∏‡¶¨
errors ‡¶è‡¶ñ‡¶®‡¶ì `onError`-‡¶è report ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º, ‡¶§‡¶¨‡ßá, ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ uncaught exceptions
rethrown ‡¶π‡¶Ø‡¶º (debug ‡¶¨‡¶æ release mode ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶ø‡¶∂‡ßá‡¶∑‡ßá)‡•§

#### ‚ùóüßπ `BlocObserver`-‡¶ï‡ßá abstract ‡¶ï‡¶∞‡¶æ

:::note[What Changed?]

bloc v8.0.0-‡¶è, `BlocObserver`-‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶ø `abstract` class-‡¶è ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ‡¶∞
‡¶Æ‡¶æ‡¶®‡ßá `BlocObserver`-‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø instance instantiate ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º ‡¶®‡¶æ‡•§

:::

##### Rationale

`BlocObserver` ‡¶è‡¶ï‡¶ü‡¶ø interface ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø‡ßá ‡¶õ‡¶ø‡¶≤‡•§ ‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ default API
implementation no-ops, `BlocObserver` ‡¶è‡¶ñ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø `abstract` class ‡¶Ø‡¶æ‡¶§‡ßá ‡¶∏‡ßç‡¶™‡¶∑‡ßç‡¶ü‡¶≠‡¶æ‡¶¨‡ßá
‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º ‡¶Ø‡ßá class-‡¶ü‡¶ø extend ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø instantiate ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
‡¶®‡¶Ø‡¶º‡•§

**v7.x.x**

```dart
void main() {
  // It was possible to create an instance of the base class.
  final observer = BlocObserver();
}
```

**v8.0.0**

```dart
class MyBlocObserver extends BlocObserver {...}

void main() {
  // Cannot instantiate the base class.
  final observer = BlocObserver(); // ERROR

  // Extend `BlocObserver` instead.
  final observer = MyBlocObserver(); // OK
}
```

#### ‚ùó‚ú® Bloc ‡¶¨‡¶®‡ßç‡¶ß ‡¶•‡¶æ‡¶ï‡¶≤‡ßá `add` `StateError` throw ‡¶ï‡¶∞‡ßá

:::note[What Changed?]

bloc v8.0.0-‡¶è, ‡¶è‡¶ï‡¶ü‡¶ø closed bloc-‡¶è `add` ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶≤‡ßá `StateError` ‡¶π‡¶¨‡ßá‡•§

:::

##### Rationale

‡¶Ü‡¶ó‡ßá, ‡¶è‡¶ï‡¶ü‡¶ø closed bloc-‡¶è `add` ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶õ‡¶ø‡¶≤ ‡¶è‡¶¨‡¶Ç internal error swallow ‡¶π‡¶Ø‡¶º‡ßá
‡¶Ø‡ßá‡¶§, ‡¶Ø‡¶æ debug ‡¶ï‡¶∞‡¶æ ‡¶ï‡¶†‡¶ø‡¶® ‡¶ï‡¶∞‡¶§ ‡¶ï‡ßá‡¶® added event process ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡¶ø‡¶≤ ‡¶®‡¶æ‡•§ ‡¶è‡¶á scenario-‡¶ü‡¶ø
‡¶Ü‡¶∞‡¶ì ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶ï‡¶∞‡¶§‡ßá, v8.0.0-‡¶è, ‡¶è‡¶ï‡¶ü‡¶ø closed bloc-‡¶è `add` ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶≤‡ßá `StateError` throw
‡¶ï‡¶∞‡¶¨‡ßá ‡¶Ø‡¶æ uncaught exception ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá report ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç `onError`-‡¶è propagate ‡¶ï‡¶∞‡¶æ
‡¶π‡¶¨‡ßá‡•§

#### ‚ùó‚ú® Bloc ‡¶¨‡¶®‡ßç‡¶ß ‡¶•‡¶æ‡¶ï‡¶≤‡ßá `emit` `StateError` throw ‡¶ï‡¶∞‡ßá

:::note[What Changed?]

bloc v8.0.0-‡¶è, ‡¶è‡¶ï‡¶ü‡¶ø closed bloc-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá `emit` ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶≤‡ßá `StateError` ‡¶π‡¶¨‡ßá‡•§

:::

##### Rationale

‡¶Ü‡¶ó‡ßá, ‡¶è‡¶ï‡¶ü‡¶ø closed bloc-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá `emit` ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶õ‡¶ø‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶ï‡ßã‡¶®‡ßã state change ‡¶ò‡¶ü‡¶§
‡¶®‡¶æ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶ï‡ßÄ ‡¶≠‡ßÅ‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶§‡¶æ‡¶∞ ‡¶ï‡ßã‡¶®‡ßã ‡¶á‡¶ô‡ßç‡¶ó‡¶ø‡¶§‡¶ì ‡¶•‡¶æ‡¶ï‡¶§ ‡¶®‡¶æ, ‡¶Ø‡¶æ debug ‡¶ï‡¶∞‡¶æ ‡¶ï‡¶†‡¶ø‡¶® ‡¶ï‡¶∞‡¶§‡•§ ‡¶è‡¶á
scenario-‡¶ü‡¶ø ‡¶Ü‡¶∞‡¶ì ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶ï‡¶∞‡¶§‡ßá, v8.0.0-‡¶è, ‡¶è‡¶ï‡¶ü‡¶ø closed bloc-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá `emit` ‡¶ï‡¶≤
‡¶ï‡¶∞‡¶≤‡ßá `StateError` throw ‡¶ï‡¶∞‡¶¨‡ßá ‡¶Ø‡¶æ uncaught exception ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá report ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç
`onError`-‡¶è propagate ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá‡•§

#### ‚ùóüßπ Deprecated APIs ‡¶∏‡¶∞‡¶æ‡¶®‡ßã

:::note[What Changed?]

bloc v8.0.0-‡¶è, ‡¶Ü‡¶ó‡ßá ‡¶•‡ßá‡¶ï‡ßá deprecated ‡¶∏‡¶¨ APIs ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§

:::

##### Summary

- `mapEventToState` ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `on<Event>`-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá
- `transformEvents` ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `EventTransformer` API-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá
- `TransitionFunction` typedef ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `EventTransformer` API-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá
- `listen` ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `stream.listen`-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá

### `package:bloc_test`

#### ‚ú® `MockBloc` ‡¶è‡¶¨‡¶Ç `MockCubit` ‡¶Ü‡¶∞ `registerFallbackValue` ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶®‡ßá‡¶á

:::note[What Changed?]

bloc_test v9.0.0-‡¶è, ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶∞ `MockBloc` ‡¶¨‡¶æ `MockCubit` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º
‡¶∏‡ßç‡¶™‡¶∑‡ßç‡¶ü‡¶≠‡¶æ‡¶¨‡ßá `registerFallbackValue` ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶®‡ßá‡¶á‡•§

:::

##### Summary

`registerFallbackValue` ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø custom type-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø `package:mocktail`
‡¶•‡ßá‡¶ï‡ßá `any()` matcher ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡•§ ‡¶Ü‡¶ó‡ßá, `registerFallbackValue`
‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø `Event` ‡¶è‡¶¨‡¶Ç `State`-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶õ‡¶ø‡¶≤ ‡¶Ø‡¶ñ‡¶® `MockBloc` ‡¶¨‡¶æ `MockCubit`
‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶§‡•§

**v8.x.x**

```dart
class FakeMyEvent extends Fake implements MyEvent {}
class FakeMyState extends Fake implements MyState {}
class MyMockBloc extends MockBloc<MyEvent, MyState> implements MyBloc {}

void main() {
  setUpAll(() {
    registerFallbackValue(FakeMyEvent());
    registerFallbackValue(FakeMyState());
  });

  // Tests...
}
```

**v9.0.0**

```dart
class MyMockBloc extends MockBloc<MyEvent, MyState> implements MyBloc {}

void main() {
  // Tests...
}
```

### `package:hydrated_bloc`

#### ‚ùó‚ú® ‡¶®‡¶§‡ßÅ‡¶® `HydratedBlocOverrides` API ‡¶ö‡¶æ‡¶≤‡ßÅ

:::note[What Changed?]

hydrated_bloc v8.0.0-‡¶è, `HydratedBloc.storage` ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
`HydratedBlocOverrides` API-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡•§

:::

##### Rationale

‡¶Ü‡¶ó‡ßá, `Storage` implementation override ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶ï‡¶ü‡¶ø global singleton ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶§‡•§

‡¶´‡¶≤‡¶∏‡ßç‡¶¨‡¶∞‡ßÇ‡¶™, application-‡¶è‡¶∞ ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶Ö‡¶Ç‡¶∂‡ßá scoped ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï `Storage` implementations
‡¶•‡¶æ‡¶ï‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶õ‡¶ø‡¶≤ ‡¶®‡¶æ‡•§ Tests ‡¶ú‡ßÅ‡¶°‡¶º‡ßá shared global state-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá test ‡¶ï‡¶∞‡¶æ‡¶ì ‡¶Ü‡¶∞‡¶ì ‡¶ï‡¶†‡¶ø‡¶®
‡¶õ‡¶ø‡¶≤‡•§

`HydratedBloc` v8.0.0 ‡¶è‡¶ï‡¶ü‡¶ø `HydratedBlocOverrides` class ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ
‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø specific `Zone`-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø `Storage` override ‡¶ï‡¶∞‡¶§‡ßá ‡¶¶‡ßá‡¶Ø‡¶º global
mutable singleton-‡¶è‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡ßá‡•§

**v7.x.x**

```dart
void main() async {
  HydratedBloc.storage = await HydratedStorage.build(
    storageDirectory: await getApplicationSupportDirectory(),
  );

  // ...
}
```

**v8.0.0**

```dart
void main() {
  final storage = await HydratedStorage.build(
    storageDirectory: await getApplicationSupportDirectory(),
  );

  HydratedBlocOverrides.runZoned(
    () {
      // ...
    },
    storage: storage,
  );
}
```

`HydratedBloc` instances `HydratedBlocOverrides.current`-‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá current
`Zone`-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø `Storage` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡•§

‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø `Zone`-‡¶ï‡ßá ‡¶§‡¶æ‡¶∞ ‡¶®‡¶ø‡¶ú‡¶∏‡ßç‡¶¨ `BlocOverrides`-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶§‡ßá
‡¶¶‡ßá‡¶Ø‡¶º‡•§

## v7.2.0

### `package:bloc`

#### ‚ú® ‡¶®‡¶§‡ßÅ‡¶® `on<Event>` API ‡¶ö‡¶æ‡¶≤‡ßÅ

:::note[What Changed?]

bloc v7.2.0-‡¶è, `mapEventToState` deprecated ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `on<Event>`-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡•§
`mapEventToState` bloc v8.0.0-‡¶è ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá‡•§

:::

##### Rationale

`on<Event>` API ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤
[[Proposal] Replace mapEventToState with on\<Event\> in Bloc](https://github.com/felangel/bloc/issues/2526)-‡¶è‡¶∞
‡¶Ö‡¶Ç‡¶∂ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá‡•§
[Dart-‡¶è ‡¶è‡¶ï‡¶ü‡¶ø issue](https://github.com/dart-lang/sdk/issues/44616)-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá
nested async generators (`async*`)-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá deal ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º `state`-‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶® ‡¶ï‡ßÄ ‡¶π‡¶¨‡ßá
‡¶§‡¶æ ‡¶∏‡¶¨‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∏‡ßç‡¶™‡¶∑‡ßç‡¶ü ‡¶®‡¶Ø‡¶º‡•§ ‡¶Ø‡¶¶‡¶ø‡¶ì issue-‡¶ü‡¶ø work around ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶â‡¶™‡¶æ‡¶Ø‡¶º ‡¶Ü‡¶õ‡ßá, bloc library-‡¶è‡¶∞
core principles-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶π‡¶≤ predictable ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡•§ `on<Event>` API library-‡¶ü‡¶ø
‡¶Ø‡¶§‡¶ü‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶¨‡¶Ç state changes-‡¶è‡¶∞ ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã
uncertainty ‡¶¶‡ßÇ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤‡•§

:::tip

‡¶Ü‡¶∞‡¶ì ‡¶§‡¶•‡ßç‡¶Ø‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø,
[full proposal ‡¶™‡¶°‡¶º‡ßÅ‡¶®](https://github.com/felangel/bloc/issues/2526)‡•§

:::

**Summary**

`on<E>` ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá type `E`-‡¶è‡¶∞ ‡¶∏‡¶¨ events-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø event handler register ‡¶ï‡¶∞‡¶§‡ßá
‡¶¶‡ßá‡¶Ø‡¶º‡•§ ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü‡¶≠‡¶æ‡¶¨‡ßá, events concurrently process ‡¶π‡¶¨‡ßá ‡¶Ø‡¶ñ‡¶® `on<E>` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá
`mapEventToState`-‡¶è‡¶∞ ‡¶¨‡¶ø‡¶™‡¶∞‡ßÄ‡¶§‡ßá ‡¶Ø‡¶æ events `sequentially` process ‡¶ï‡¶∞‡ßá‡•§

**v7.1.0**

```dart
abstract class CounterEvent {}
class Increment extends CounterEvent {}

class CounterBloc extends Bloc<CounterEvent, int> {
  CounterBloc() : super(0);

  @override
  Stream<int> mapEventToState(CounterEvent event) async* {
    if (event is Increment) {
      yield state + 1;
    }
  }
}
```

**v7.2.0**

```dart
abstract class CounterEvent {}
class Increment extends CounterEvent {}

class CounterBloc extends Bloc<CounterEvent, int> {
  CounterBloc() : super(0) {
    on<Increment>((event, emit) => emit(state + 1));
  }
}
```

:::note

‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø registered `EventHandler` ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá ‡¶§‡¶æ‡¶á ‡¶è‡¶ü‡¶ø ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶Ø‡ßá
‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ø‡ßá ‡¶ß‡¶∞‡¶®‡ßá‡¶∞ transformer apply ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶® ‡¶§‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá event handlers
register ‡¶ï‡¶∞‡ßÅ‡¶®‡•§

:::

‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ø‡¶¶‡¶ø v7.1.0-‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã exact same behavior ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá ‡¶ö‡¶æ‡¶® ‡¶Ü‡¶™‡¶®‡¶ø ‡¶∏‡¶¨ events-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø
single event handler register ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶® ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ï‡¶ü‡¶ø `sequential` transformer apply
‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®:

```dart
import 'package:bloc/bloc.dart';
import 'package:bloc_concurrency/bloc_concurrency.dart';

class MyBloc extends Bloc<MyEvent, MyState> {
  MyBloc() : super(MyState()) {
    on<MyEvent>(_onEvent, transformer: sequential())
  }

  FutureOr<void> _onEvent(MyEvent event, Emitter<MyState> emit) async {
    // TODO: logic goes here...
  }
}
```

‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ application-‡¶è ‡¶∏‡¶¨ blocs-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø default `EventTransformer` override
‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®:

```dart
import 'package:bloc/bloc.dart';
import 'package:bloc_concurrency/bloc_concurrency.dart';

void main() {
  Bloc.transformer = sequential<dynamic>();
  ...
}
```

#### ‚ú® ‡¶®‡¶§‡ßÅ‡¶® `EventTransformer` API ‡¶ö‡¶æ‡¶≤‡ßÅ

:::note[What Changed?]

bloc v7.2.0-‡¶è, `transformEvents` deprecated ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `EventTransformer` API-‡¶è‡¶∞
‡¶™‡¶ï‡ßç‡¶∑‡ßá‡•§ `transformEvents` bloc v8.0.0-‡¶è ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá‡•§

:::

##### Rationale

`on<Event>` API per event handler ‡¶è‡¶ï‡¶ü‡¶ø custom event transformer ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶¶‡¶∞‡¶ú‡¶æ
‡¶ñ‡ßÅ‡¶≤‡ßá ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® `EventTransformer` typedef ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ
‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø event handler-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø incoming event stream transform ‡¶ï‡¶∞‡¶§‡ßá
‡¶¶‡ßá‡¶Ø‡¶º ‡¶∏‡¶¨ events-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø single event transformer specify ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡ßá‡•§

**Summary**

‡¶è‡¶ï‡¶ü‡¶ø `EventTransformer` incoming events-‡¶è‡¶∞ stream ‡¶è‡¶ï‡¶ü‡¶ø `EventMapper` (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞
event handler) ‡¶∏‡¶π ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¶‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶è‡¶¨‡¶Ç events-‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® stream ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡ßá‡•§

```dart
typedef EventTransformer<Event> = Stream<Event> Function(Stream<Event> events, EventMapper<Event> mapper)
```

Default `EventTransformer` ‡¶∏‡¶¨ events concurrently process ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ü‡¶æ
‡¶è‡¶Æ‡¶®:

```dart
EventTransformer<E> concurrent<E>() {
  return (events, mapper) => events.flatMap(mapper);
}
```

:::tip

[package:bloc_concurrency](https://pub.dev/packages/bloc_concurrency) ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
custom event transformers-‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø opinionated set-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

:::

**v7.1.0**

```dart
@override
Stream<Transition<MyEvent, MyState>> transformEvents(events, transitionFn) {
  return events
    .debounceTime(const Duration(milliseconds: 300))
    .flatMap(transitionFn);
}
```

**v7.2.0**

```dart
/// Define a custom `EventTransformer`
EventTransformer<MyEvent> debounce<MyEvent>(Duration duration) {
  return (events, mapper) => events.debounceTime(duration).flatMap(mapper);
}

MyBloc() : super(MyState()) {
  /// Apply the custom `EventTransformer` to the `EventHandler`
  on<MyEvent>(_onEvent, transformer: debounce(const Duration(milliseconds: 300)))
}
```

#### ‚ö†Ô∏è `transformTransitions` API Deprecate

:::note[What Changed?]

bloc v7.2.0-‡¶è, `transformTransitions` deprecated ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá `stream` API
override ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡•§ `transformTransitions` bloc v8.0.0-‡¶è ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá‡•§

:::

##### Rationale

`Bloc`-‡¶è `stream` getter outbound stream of states override ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶π‡¶ú ‡¶ï‡¶∞‡ßá ‡¶§‡ßã‡¶≤‡ßá ‡¶§‡¶æ‡¶á
‡¶è‡¶ï‡¶ü‡¶ø separate `transformTransitions` API ‡¶¨‡¶ú‡¶æ‡¶Ø‡¶º ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶Ü‡¶∞ ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶¨‡¶æ‡¶® ‡¶®‡¶Ø‡¶º‡•§

**Summary**

**v7.1.0**

```dart
@override
Stream<Transition<Event, State>> transformTransitions(
  Stream<Transition<Event, State>> transitions,
) {
  return transitions.debounceTime(const Duration(milliseconds: 42));
}
```

**v7.2.0**

```dart
@override
Stream<State> get stream => super.stream.debounceTime(const Duration(milliseconds: 42));
```

## v7.0.0

### `package:bloc`

#### ‚ùó Bloc ‡¶è‡¶¨‡¶Ç Cubit BlocBase extend ‡¶ï‡¶∞‡ßá

##### Rationale

‡¶è‡¶ï‡¶ú‡¶® ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá, blocs ‡¶è‡¶¨‡¶Ç cubits-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ü‡¶æ awkward ‡¶õ‡¶ø‡¶≤‡•§ ‡¶Ø‡¶ñ‡¶®
cubit ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤ ‡¶è‡¶ü‡¶ø blocs-‡¶è‡¶∞ base class ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤ ‡¶Ø‡¶æ
‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø‡¶∏‡¶ô‡ßç‡¶ó‡¶§ ‡¶õ‡¶ø‡¶≤ ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶è‡¶ü‡¶ø‡¶∞ functionality-‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø subset ‡¶õ‡¶ø‡¶≤ ‡¶è‡¶¨‡¶Ç blocs ‡¶ï‡ßá‡¶¨‡¶≤ Cubit
extend ‡¶ï‡¶∞‡¶§ ‡¶è‡¶¨‡¶Ç additional APIs define ‡¶ï‡¶∞‡¶§‡•§ ‡¶è‡¶ü‡¶ø ‡¶ï‡¶Ø‡¶º‡ßá‡¶ï‡¶ü‡¶ø drawback ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶è‡¶∏‡ßá‡¶õ‡¶ø‡¶≤:

- ‡¶∏‡¶¨ APIs ‡¶π‡¶Ø‡¶º accuracy-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø cubit accept ‡¶ï‡¶∞‡¶§‡ßá rename ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶Ö‡¶•‡¶¨‡¶æ
  consistency-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø bloc ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶Ø‡¶¶‡¶ø‡¶ì hierarchically ‡¶è‡¶ü‡¶ø inaccurate
  ([#1708](https://github.com/felangel/bloc/issues/1708),
  [#1560](https://github.com/felangel/bloc/issues/1560))‡•§

- Cubit-‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø common base ‡¶•‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø Stream extend ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç EventSink
  implement ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶Ø‡¶æ‡¶§‡ßá BlocBuilder, BlocListener ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø‡¶∞ ‡¶Æ‡¶§‡ßã widgets
  implement ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º ([#1429](https://github.com/felangel/bloc/issues/1429))‡•§

‡¶™‡¶∞‡ßá, ‡¶Ü‡¶Æ‡¶∞‡¶æ relationship-‡¶ü‡¶ø invert ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç bloc-‡¶ï‡ßá base class ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤‡¶æ‡¶Æ
‡¶Ø‡¶æ ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ bullet-‡¶ü‡¶ø ‡¶Ü‡¶Ç‡¶∂‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø issues ‡¶®‡¶ø‡¶Ø‡¶º‡ßá
‡¶è‡¶∏‡ßá‡¶õ‡¶ø‡¶≤:

- Cubit API bloated underlying bloc APIs-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶Ø‡ßá‡¶Æ‡¶® mapEventToState, add,
  etc. ([#2228](https://github.com/felangel/bloc/issues/2228))
  - ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶∞‡¶æ technically ‡¶è‡¶á APIs invoke ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç things break ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá
- ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶è‡¶ñ‡¶®‡¶ì ‡¶è‡¶ï‡¶á issue ‡¶Ü‡¶õ‡ßá cubit entire stream API expose ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã
  ([#1429](https://github.com/felangel/bloc/issues/1429))

‡¶è‡¶á issues-‡¶ó‡ßÅ‡¶≤‡¶ø ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ `Bloc` ‡¶è‡¶¨‡¶Ç `Cubit` ‡¶â‡¶≠‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø base class
‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø `BlocBase` ‡¶®‡¶æ‡¶Æ‡ßá ‡¶Ø‡¶æ‡¶§‡ßá upstream components ‡¶è‡¶ñ‡¶®‡¶ì ‡¶â‡¶≠‡¶Ø‡¶º bloc ‡¶è‡¶¨‡¶Ç cubit
instances-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá interoperate ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ entire `Stream` ‡¶è‡¶¨‡¶Ç `EventSink`
API ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø expose ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá‡•§

**Summary**

**BlocObserver**

**v6.1.x**

```dart
class SimpleBlocObserver extends BlocObserver {
  @override
  void onCreate(Cubit cubit) {...}

  @override
  void onEvent(Bloc bloc, Object event) {...}

  @override
  void onChange(Cubit cubit, Object event) {...}

  @override
  void onTransition(Bloc bloc, Transition transition) {...}

  @override
  void onError(Cubit cubit, Object error, StackTrace stackTrace) {...}

  @override
  void onClose(Cubit cubit) {...}
}
```

**v7.0.0**

```dart
class SimpleBlocObserver extends BlocObserver {
  @override
  void onCreate(BlocBase bloc) {...}

  @override
  void onEvent(Bloc bloc, Object event) {...}

  @override
  void onChange(BlocBase bloc, Object? event) {...}

  @override
  void onTransition(Bloc bloc, Transition transition) {...}

  @override
  void onError(BlocBase bloc, Object error, StackTrace stackTrace) {...}

  @override
  void onClose(BlocBase bloc) {...}
}
```

**Bloc/Cubit**

**v6.1.x**

```dart
final bloc = MyBloc();
bloc.listen((state) {...});

final cubit = MyCubit();
cubit.listen((state) {...});
```

**v7.0.0**

```dart
final bloc = MyBloc();
bloc.stream.listen((state) {...});

final cubit = MyCubit();
cubit.stream.listen((state) {...});
```

### `package:bloc_test`

#### ‚ùóseed returns a function to support dynamic values

##### Rationale

In order to support having a mutable seed value which can be updated dynamically
in `setUp`, `seed` returns a function.

**Summary**

**v7.x.x**

```dart
blocTest(
  '...',
  seed: MyState(),
  ...
);
```

**v8.0.0**

```dart
blocTest(
  '...',
  seed: () => MyState(),
  ...
);
```

#### ‚ùóexpect returns a function to support dynamic values and includes matcher support

##### Rationale

In order to support having a mutable expectation which can be updated
dynamically in `setUp`, `expect` returns a function. `expect` also supports
`Matchers`.

**Summary**

**v7.x.x**

```dart
blocTest(
  '...',
  expect: [MyStateA(), MyStateB()],
  ...
);
```

**v8.0.0**

```dart
blocTest(
  '...',
  expect: () => [MyStateA(), MyStateB()],
  ...
);

// It can also be a `Matcher`
blocTest(
  '...',
  expect: () => contains(MyStateA()),
  ...
);
```

#### ‚ùóerrors returns a function to support dynamic values and includes matcher support

##### Rationale

In order to support having a mutable errors which can be updated dynamically in
`setUp`, `errors` returns a function. `errors` also supports `Matchers`.

**Summary**

**v7.x.x**

```dart
blocTest(
  '...',
  errors: [MyError()],
  ...
);
```

**v8.0.0**

```dart
blocTest(
  '...',
  errors: () => [MyError()],
  ...
);

// It can also be a `Matcher`
blocTest(
  '...',
  errors: () => contains(MyError()),
  ...
);
```

#### ‚ùóMockBloc and MockCubit

##### Rationale

To support stubbing of various core APIs, `MockBloc` and `MockCubit` are
exported as part of the `bloc_test` package. Previously, `MockBloc` had to be
used for both `Bloc` and `Cubit` instances which was not intuitive.

**Summary**

**v7.x.x**

```dart
class MockMyBloc extends MockBloc<MyState> implements MyBloc {}
class MockMyCubit extends MockBloc<MyState> implements MyBloc {}
```

**v8.0.0**

```dart
class MockMyBloc extends MockBloc<MyEvent, MyState> implements MyBloc {}
class MockMyCubit extends MockCubit<MyState> implements MyCubit {}
```

#### ‚ùóMocktail Integration

##### Rationale

Due to various limitations of the null-safe
[package:mockito](https://pub.dev/packages/mockito) described
[here](https://github.com/dart-lang/mockito/blob/master/NULL_SAFETY_README.md#problems-with-typical-mocking-and-stubbing),
[package:mocktail](https://pub.dev/packages/mocktail) is used by `MockBloc` and
`MockCubit`. This allows developers to continue using a familiar mocking API
without the need to manually write stubs or rely on code generation.

**Summary**

**v7.x.x**

```dart
import 'package:mockito/mockito.dart';

...

when(bloc.state).thenReturn(MyState());
verify(bloc.add(any)).called(1);
```

**v8.0.0**

```dart
import 'package:mocktail/mocktail.dart';

...

when(() => bloc.state).thenReturn(MyState());
verify(() => bloc.add(any())).called(1);
```

> Please refer to [#347](https://github.com/dart-lang/mockito/issues/347) as
> well as the
> [mocktail documentation](https://github.com/felangel/mocktail/tree/main/packages/mocktail)
> for more information.

### `package:flutter_bloc`

#### ‚ùó rename `cubit` parameter to `bloc`

##### Rationale

As a result of the refactor in `package:bloc` to introduce `BlocBase` which
`Bloc` and `Cubit` extend, the parameters of `BlocBuilder`, `BlocConsumer`, and
`BlocListener` were renamed from `cubit` to `bloc` because the widgets operate
on the `BlocBase` type. This also further aligns with the library name and
hopefully improves readability.

**Summary**

**v6.1.x**

```dart
BlocBuilder(
  cubit: myBloc,
  ...
)

BlocListener(
  cubit: myBloc,
  ...
)

BlocConsumer(
  cubit: myBloc,
  ...
)
```

**v7.0.0**

```dart
BlocBuilder(
  bloc: myBloc,
  ...
)

BlocListener(
  bloc: myBloc,
  ...
)

BlocConsumer(
  bloc: myBloc,
  ...
)
```

### `package:hydrated_bloc`

#### ‚ùóstorageDirectory is required when calling HydratedStorage.build

##### Rationale

In order to make `package:hydrated_bloc` a pure Dart package, the dependency on
[package:path_provider](https://pub.dev/packages/path_provider) was removed and
the `storageDirectory` parameter when calling `HydratedStorage.build` is
required and no longer defaults to `getTemporaryDirectory`.

**Summary**

**v6.x.x**

```dart
HydratedBloc.storage = await HydratedStorage.build();
```

**v7.0.0**

```dart
import 'package:path_provider/path_provider.dart';

...

HydratedBloc.storage = await HydratedStorage.build(
  storageDirectory: await getTemporaryDirectory(),
);
```

## v6.1.0

### `package:flutter_bloc`

#### ‚ùócontext.bloc ‡¶è‡¶¨‡¶Ç context.repository deprecated ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá context.read ‡¶è‡¶¨‡¶Ç context.watch-‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑‡ßá

##### Rationale

`context.read`, `context.watch`, ‡¶è‡¶¨‡¶Ç `context.select` ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá existing
[provider](https://pub.dev/packages/provider) API-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá align ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ø‡¶æ ‡¶Ö‡¶®‡ßá‡¶ï
‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞ familiar ‡¶è‡¶¨‡¶Ç community-‡¶è‡¶∞ ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶â‡¶§‡ßç‡¶•‡¶æ‡¶™‡¶ø‡¶§ issues-‡¶ó‡ßÅ‡¶≤‡¶ø address ‡¶ï‡¶∞‡¶§‡ßá‡•§
Code-‡¶è‡¶∞ safety ‡¶â‡¶®‡ßç‡¶®‡¶§ ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶¨‡¶Ç consistency ‡¶¨‡¶ú‡¶æ‡¶Ø‡¶º ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá, `context.bloc` deprecated
‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶è‡¶ü‡¶ø `context.read` ‡¶¨‡¶æ `context.watch` ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá replace ‡¶ï‡¶∞‡¶æ ‡¶Ø‡ßá‡¶§‡ßá
‡¶™‡¶æ‡¶∞‡ßá ‡¶è‡¶ü‡¶ø `build`-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º ‡¶ï‡¶ø‡¶®‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞ ‡¶ï‡¶∞‡ßá‡•§

**context.watch**

`context.watch` ‡¶è‡¶ï‡¶ü‡¶ø
[MultiBlocBuilder](https://github.com/felangel/bloc/issues/538) ‡¶•‡¶æ‡¶ï‡¶æ‡¶∞ request
address ‡¶ï‡¶∞‡ßá ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶ø single `Builder`-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï blocs watch ‡¶ï‡¶∞‡¶§‡ßá
‡¶™‡¶æ‡¶∞‡¶ø multiple states-‡¶è‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá UI render ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø:

```dart
Builder(
  builder: (context) {
    final stateA = context.watch<BlocA>().state;
    final stateB = context.watch<BlocB>().state;
    final stateC = context.watch<BlocC>().state;

    // return a Widget which depends on the state of BlocA, BlocB, and BlocC
  }
);
```

**context.select**

`context.select` ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø bloc-‡¶è‡¶∞ state-‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡¶Ç‡¶∂‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá UI
render/update ‡¶ï‡¶∞‡¶§‡ßá ‡¶¶‡ßá‡¶Ø‡¶º ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ï‡¶ü‡¶ø
[simpler buildWhen](https://github.com/felangel/bloc/issues/1521) ‡¶•‡¶æ‡¶ï‡¶æ‡¶∞ request
address ‡¶ï‡¶∞‡ßá‡•§

```dart
final name = context.select((UserBloc bloc) => bloc.state.user.name);
```

‡¶â‡¶™‡¶∞‡ßá‡¶∞ snippet ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ access ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶¨‡¶Ç widget rebuild ‡¶ï‡¶∞‡¶§‡ßá ‡¶¶‡ßá‡¶Ø‡¶º ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Ø‡¶ñ‡¶®
current user-‡¶è‡¶∞ name ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡¶Ø‡¶º‡•§

**context.read**

‡¶Ø‡¶¶‡¶ø‡¶ì `context.read` `context.bloc`-‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶¶‡ßá‡¶ñ‡¶æ‡¶Ø‡¶º ‡¶∏‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ subtle ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ
significant differences ‡¶Ü‡¶õ‡ßá‡•§ ‡¶â‡¶≠‡¶Ø‡¶º‡¶á ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶ø bloc access ‡¶ï‡¶∞‡¶§‡ßá ‡¶¶‡ßá‡¶Ø‡¶º ‡¶è‡¶ï‡¶ü‡¶ø
`BuildContext` ‡¶∏‡¶π ‡¶è‡¶¨‡¶Ç rebuilds ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ; ‡¶§‡¶¨‡ßá, `context.read` `build`
method-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø call ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º ‡¶®‡¶æ‡•§ `build`-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá `context.bloc` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞
‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶¶‡ßÅ‡¶ü‡¶ø main ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶Ü‡¶õ‡ßá:

1. **Bloc-‡¶è‡¶∞ state access ‡¶ï‡¶∞‡¶§‡ßá**

```dart
@override
Widget build(BuildContext context) {
  final state = context.bloc<MyBloc>().state;
  return Text('$state');
}
```

‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ error-prone ‡¶ï‡¶æ‡¶∞‡¶£ `Text` widget rebuild ‡¶π‡¶¨‡ßá ‡¶®‡¶æ ‡¶Ø‡¶¶‡¶ø bloc-‡¶è‡¶∞ state
‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡¶Ø‡¶º‡•§ ‡¶è‡¶á scenario-‡¶§‡ßá, ‡¶π‡¶Ø‡¶º `BlocBuilder` ‡¶¨‡¶æ `context.watch` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ
‡¶â‡¶ö‡¶ø‡¶§‡•§

```dart
@override
Widget build(BuildContext context) {
  final state = context.watch<MyBloc>().state;
  return Text('$state');
}
```

‡¶Ö‡¶•‡¶¨‡¶æ

```dart
@override
Widget build(BuildContext context) {
  return BlocBuilder<MyBloc, MyState>(
    builder: (context, state) => Text('$state'),
  );
}
```

:::note

`build` method-‡¶è‡¶∞ root-‡¶è `context.watch` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá bloc state ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡¶≤‡ßá
entire widget rebuild ‡¶π‡¶¨‡ßá‡•§ ‡¶Ø‡¶¶‡¶ø entire widget rebuild ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶π‡¶Ø‡¶º
`BlocBuilder` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá parts-‡¶ó‡ßÅ‡¶≤‡¶ø rebuild ‡¶ï‡¶∞‡¶æ ‡¶â‡¶ö‡¶ø‡¶§ ‡¶∏‡ßá‡¶ó‡ßÅ‡¶≤‡¶ø wrap ‡¶ï‡¶∞‡¶§‡ßá,
rebuilds scope ‡¶ï‡¶∞‡¶§‡ßá `Builder` ‡¶∏‡¶π `context.watch` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶Ö‡¶•‡¶¨‡¶æ widget-‡¶ü‡¶ø
smaller widgets-‡¶è decompose ‡¶ï‡¶∞‡ßÅ‡¶®‡•§

:::

2. **Bloc access ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ø‡¶æ‡¶§‡ßá ‡¶è‡¶ï‡¶ü‡¶ø event add ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º**

```dart
@override
Widget build(BuildContext context) {
  final bloc = context.bloc<MyBloc>();
  return ElevatedButton(
    onPressed: () => bloc.add(MyEvent()),
    ...
  )
}
```

‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ inefficient ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø rebuild-‡¶è bloc lookup ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá ‡¶Ø‡¶ñ‡¶®
bloc ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶Ø‡¶ñ‡¶® user `ElevatedButton` tap ‡¶ï‡¶∞‡ßá‡•§ ‡¶è‡¶á scenario-‡¶§‡ßá, bloc
‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø access ‡¶ï‡¶∞‡¶§‡ßá `context.read` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® (‡¶è‡¶á ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá,
`onPressed` callback-‡¶è)‡•§

```dart
@override
Widget build(BuildContext context) {
  return ElevatedButton(
    onPressed: () => context.read<MyBloc>().add(MyEvent()),
    ...
  )
}
```

**Summary**

**v6.0.x**

```dart
@override
Widget build(BuildContext context) {
  final bloc = context.bloc<MyBloc>();
  return ElevatedButton(
    onPressed: () => bloc.add(MyEvent()),
    ...
  )
}
```

**v6.1.x**

```dart
@override
Widget build(BuildContext context) {
  return ElevatedButton(
    onPressed: () => context.read<MyBloc>().add(MyEvent()),
    ...
  )
}
```

?> ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø event add ‡¶ï‡¶∞‡¶§‡ßá bloc access ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º, bloc access ‡¶ï‡¶∞‡ßÅ‡¶® `context.read`
‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá callback-‡¶è ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡•§

**v6.0.x**

```dart
@override
Widget build(BuildContext context) {
  final state = context.bloc<MyBloc>().state;
  return Text('$state');
}
```

**v6.1.x**

```dart
@override
Widget build(BuildContext context) {
  final state = context.watch<MyBloc>().state;
  return Text('$state');
}
```

?> Bloc-‡¶è‡¶∞ state access ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º `context.watch` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡¶æ‡¶§‡ßá ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ
‡¶Ø‡¶æ‡¶Ø‡¶º state ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡¶≤‡ßá widget rebuild ‡¶π‡¶Ø‡¶º‡•§

## v6.0.0

### `package:bloc`

#### ‚ùóBlocObserver onError Cubit ‡¶®‡ßá‡¶Ø‡¶º

##### Rationale

`Cubit`-‡¶è‡¶∞ integration-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá, `onError` ‡¶è‡¶ñ‡¶® `Bloc` ‡¶è‡¶¨‡¶Ç `Cubit` instances
‡¶â‡¶≠‡¶Ø‡¶º‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá shared‡•§ ‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ `Cubit` base, `BlocObserver` `onError` override-‡¶è
`Bloc` type-‡¶è‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡ßá ‡¶è‡¶ï‡¶ü‡¶ø `Cubit` type accept ‡¶ï‡¶∞‡¶¨‡ßá‡•§

**v5.x.x**

```dart
class MyBlocObserver extends BlocObserver {
  @override
  void onError(Bloc bloc, Object error, StackTrace stackTrace) {
    super.onError(bloc, error, stackTrace);
  }
}
```

**v6.0.0**

```dart
class MyBlocObserver extends BlocObserver {
  @override
  void onError(Cubit cubit, Object error, StackTrace stackTrace) {
    super.onError(cubit, error, stackTrace);
  }
}
```

#### ‚ùóBloc subscription-‡¶è last state emit ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ

##### Rationale

‡¶è‡¶á ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡¶ü‡¶ø `Bloc` ‡¶è‡¶¨‡¶Ç `Cubit`-‡¶ï‡ßá `Dart`-‡¶è built-in `Stream` behavior-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá
align ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤‡•§ ‡¶è‡¶õ‡¶æ‡¶°‡¶º‡¶æ‡¶ì, `Cubit`-‡¶è‡¶∞ context-‡¶è ‡¶è‡¶á old behavior
conform ‡¶ï‡¶∞‡¶æ ‡¶Ö‡¶®‡ßá‡¶ï unintended side-effects ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤ ‡¶è‡¶¨‡¶Ç overall ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø
packages ‡¶Ø‡ßá‡¶Æ‡¶® `flutter_bloc` ‡¶è‡¶¨‡¶Ç `bloc_test`-‡¶è‡¶∞ internal implementations ‡¶ú‡¶ü‡¶ø‡¶≤
‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤ unnecessarily (`skip(1)`, etc... ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®)‡•§

**v5.x.x**

```dart
final bloc = MyBloc();
bloc.listen(print);
```

‡¶Ü‡¶ó‡ßá, ‡¶â‡¶™‡¶∞‡ßã‡¶ï‡ßç‡¶§ snippet bloc-‡¶è‡¶∞ initial state output ‡¶ï‡¶∞‡¶§ ‡¶è‡¶∞ ‡¶™‡¶∞‡ßá subsequent state
changes‡•§

**v6.x.x**

v6.0.0-‡¶è, ‡¶â‡¶™‡¶∞‡ßã‡¶ï‡ßç‡¶§ snippet initial state output ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ outputs
subsequent state changes‡•§ Previous behavior ‡¶®‡¶ø‡¶Æ‡ßç‡¶®‡¶≤‡¶ø‡¶ñ‡¶ø‡¶§ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ö‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡¶æ ‡¶Ø‡ßá‡¶§‡ßá
‡¶™‡¶æ‡¶∞‡ßá:

```dart
final bloc = MyBloc();
print(bloc.state);
bloc.listen(print);
```

?> **Note**: ‡¶è‡¶á ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ direct bloc subscriptions-‡¶è‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞‡¶∂‡ßÄ‡¶≤
code-‡¶ï‡ßá ‡¶™‡ßç‡¶∞‡¶≠‡¶æ‡¶¨‡¶ø‡¶§ ‡¶ï‡¶∞‡¶¨‡ßá‡•§ `BlocBuilder`, `BlocListener`, ‡¶¨‡¶æ `BlocConsumer` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞
‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º behavior-‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã noticeable change ‡¶•‡¶æ‡¶ï‡¶¨‡ßá ‡¶®‡¶æ‡•§

### `package:bloc_test`

#### ‚ùóMockBloc only requires State type

##### Rationale

It is not necessary and eliminates extra code while also making `MockBloc`
compatible with `Cubit`.

**v5.x.x**

```dart
class MockCounterBloc extends MockBloc<CounterEvent, int> implements CounterBloc {}
```

**v6.0.0**

```dart
class MockCounterBloc extends MockBloc<int> implements CounterBloc {}
```

#### ‚ùówhenListen only requires State type

##### Rationale

It is not necessary and eliminates extra code while also making `whenListen`
compatible with `Cubit`.

**v5.x.x**

```dart
whenListen<CounterEvent,int>(bloc, Stream.fromIterable([0, 1, 2, 3]));
```

**v6.0.0**

```dart
whenListen<int>(bloc, Stream.fromIterable([0, 1, 2, 3]));
```

#### ‚ùóblocTest does not require Event type

##### Rationale

It is not necessary and eliminates extra code while also making `blocTest`
compatible with `Cubit`.

**v5.x.x**

```dart
blocTest<CounterBloc, CounterEvent, int>(
  'emits [1] when increment is called',
  build: () async => CounterBloc(),
  act: (bloc) => bloc.add(CounterEvent.increment),
  expect: const <int>[1],
);
```

**v6.0.0**

```dart
blocTest<CounterBloc, int>(
  'emits [1] when increment is called',
  build: () => CounterBloc(),
  act: (bloc) => bloc.add(CounterEvent.increment),
  expect: const <int>[1],
);
```

#### ‚ùóblocTest skip defaults to 0

##### Rationale

Since `bloc` and `cubit` instances will no longer emit the latest state for new
subscriptions, it was no longer necessary to default `skip` to `1`.

**v5.x.x**

```dart
blocTest<CounterBloc, CounterEvent, int>(
  'emits [0] when skip is 0',
  build: () async => CounterBloc(),
  skip: 0,
  expect: const <int>[0],
);
```

**v6.0.0**

```dart
blocTest<CounterBloc, int>(
  'emits [] when skip is 0',
  build: () => CounterBloc(),
  skip: 0,
  expect: const <int>[],
);
```

The initial state of a bloc or cubit can be tested with the following:

```dart
test('initial state is correct', () {
  expect(MyBloc().state, InitialState());
});
```

#### ‚ùóblocTest make build synchronous

##### Rationale

Previously, `build` was made `async` so that various preparation could be done
to put the bloc under test in a specific state. It is no longer necessary and
also resolves several issues due to the added latency between the build and the
subscription internally. Instead of doing async prep to get a bloc in a desired
state we can now set the bloc state by chaining `emit` with the desired state.

**v5.x.x**

```dart
blocTest<CounterBloc, CounterEvent, int>(
  'emits [2] when increment is added',
  build: () async {
    final bloc = CounterBloc();
    bloc.add(CounterEvent.increment);
    await bloc.take(2);
    return bloc;
  }
  act: (bloc) => bloc.add(CounterEvent.increment),
  expect: const <int>[2],
);
```

**v6.0.0**

```dart
blocTest<CounterBloc, int>(
  'emits [2] when increment is added',
  build: () => CounterBloc()..emit(1),
  act: (bloc) => bloc.add(CounterEvent.increment),
  expect: const <int>[2],
);
```

:::note

`emit` is only visible for testing and should never be used outside of tests.

:::

### `package:flutter_bloc`

#### ‚ùóBlocBuilder bloc parameter renamed to cubit

##### Rationale

In order to make `BlocBuilder` interoperate with `bloc` and `cubit` instances
the `bloc` parameter was renamed to `cubit` (since `Cubit` is the base class).

**v5.x.x**

```dart
BlocBuilder(
  bloc: myBloc,
  builder: (context, state) {...}
)
```

**v6.0.0**

```dart
BlocBuilder(
  cubit: myBloc,
  builder: (context, state) {...}
)
```

#### ‚ùóBlocListener bloc parameter renamed to cubit

##### Rationale

In order to make `BlocListener` interoperate with `bloc` and `cubit` instances
the `bloc` parameter was renamed to `cubit` (since `Cubit` is the base class).

**v5.x.x**

```dart
BlocListener(
  bloc: myBloc,
  listener: (context, state) {...}
)
```

**v6.0.0**

```dart
BlocListener(
  cubit: myBloc,
  listener: (context, state) {...}
)
```

#### ‚ùóBlocConsumer bloc parameter renamed to cubit

##### Rationale

In order to make `BlocConsumer` interoperate with `bloc` and `cubit` instances
the `bloc` parameter was renamed to `cubit` (since `Cubit` is the base class).

**v5.x.x**

```dart
BlocConsumer(
  bloc: myBloc,
  listener: (context, state) {...},
  builder: (context, state) {...}
)
```

**v6.0.0**

```dart
BlocConsumer(
  cubit: myBloc,
  listener: (context, state) {...},
  builder: (context, state) {...}
)
```

---

## v5.0.0

### `package:bloc`

#### ‚ùóinitialState ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá

##### Rationale

‡¶è‡¶ï‡¶ú‡¶® ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá, ‡¶è‡¶ï‡¶ü‡¶ø bloc ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º `initialState` override ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶≤‡ßá
‡¶¶‡ßÅ‡¶ü‡¶ø main issue ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¶‡ßá‡¶Ø‡¶º:

- Bloc-‡¶è‡¶∞ `initialState` dynamic ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá reference
  ‡¶ï‡¶∞‡¶æ ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá (bloc-‡¶è‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá‡¶ì)‡•§ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶â‡¶™‡¶æ‡¶Ø‡¶º‡ßá, ‡¶è‡¶ü‡¶ø internal bloc information UI
  layer-‡¶è leak ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§
- ‡¶è‡¶ü‡¶ø verbose‡•§

**v4.x.x**

```dart
class CounterBloc extends Bloc<CounterEvent, int> {
  @override
  int get initialState => 0;

  ...
}
```

**v5.0.0**

```dart
class CounterBloc extends Bloc<CounterEvent, int> {
  CounterBloc() : super(0);

  ...
}
```

?> ‡¶Ü‡¶∞‡¶ì ‡¶§‡¶•‡ßç‡¶Ø‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® [#1304](https://github.com/felangel/bloc/issues/1304)

#### ‚ùóBlocDelegate-‡¶ï‡ßá BlocObserver ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£

##### Rationale

`BlocDelegate` ‡¶®‡¶æ‡¶Æ‡¶ü‡¶ø class-‡¶ü‡¶ø ‡¶Ø‡ßá role ‡¶™‡¶æ‡¶≤‡¶® ‡¶ï‡¶∞‡¶§ ‡¶§‡¶æ‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø accurate description ‡¶õ‡¶ø‡¶≤
‡¶®‡¶æ‡•§ `BlocDelegate` suggests ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßá class-‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø active role ‡¶™‡¶æ‡¶≤‡¶® ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá
‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨‡ßá `BlocDelegate`-‡¶è‡¶∞ intended role ‡¶õ‡¶ø‡¶≤ ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø passive component ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ
‡¶ï‡ßá‡¶¨‡¶≤ application-‡¶è ‡¶∏‡¶¨ blocs observe ‡¶ï‡¶∞‡ßá‡•§

:::note

`BlocObserver`-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá user-facing functionality ‡¶¨‡¶æ features handle ‡¶ï‡¶∞‡¶æ ‡¶â‡¶ö‡¶ø‡¶§
‡¶®‡¶Ø‡¶º ideally‡•§

:::

**v4.x.x**

```dart
class MyBlocDelegate extends BlocDelegate {
  ...
}
```

**v5.0.0**

```dart
class MyBlocObserver extends BlocObserver {
  ...
}
```

#### ‚ùóBlocSupervisor ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá

##### Rationale

`BlocSupervisor` ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶ø component ‡¶õ‡¶ø‡¶≤ ‡¶Ø‡¶æ ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶ú‡¶æ‡¶®‡¶§‡ßá ‡¶è‡¶¨‡¶Ç interact ‡¶ï‡¶∞‡¶§‡ßá
‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤ ‡¶è‡¶ï‡¶ü‡¶ø custom `BlocDelegate` specify ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶è‡¶ï‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø‡ßá‡•§
`BlocObserver`-‡¶è ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Æ‡¶®‡ßá ‡¶ï‡¶∞‡¶ø ‡¶è‡¶ü‡¶ø developer experience ‡¶â‡¶®‡ßç‡¶®‡¶§
‡¶ï‡¶∞‡ßá‡¶õ‡ßá observer ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø bloc-‡¶è set ‡¶ï‡¶∞‡¶§‡ßá‡•§

?> ‡¶è‡¶á ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡¶ü‡¶ø ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø bloc add-ons ‡¶Ø‡ßá‡¶Æ‡¶® `HydratedStorage`-‡¶ï‡ßá
`BlocObserver` ‡¶•‡ßá‡¶ï‡ßá decouple ‡¶ï‡¶∞‡¶§‡ßá‡¶ì ‡¶∏‡¶ï‡ßç‡¶∑‡¶Æ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡•§

**v4.x.x**

```dart
BlocSupervisor.delegate = MyBlocDelegate();
```

**v5.0.0**

```dart
Bloc.observer = MyBlocObserver();
```

### `package:flutter_bloc`

#### ‚ùóBlocBuilder condition-‡¶ï‡ßá buildWhen ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£

##### Rationale

`BlocBuilder` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º, ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶ó‡ßá ‡¶è‡¶ï‡¶ü‡¶ø `condition` specify ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶§‡¶æ‡¶Æ
‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶§‡ßá `builder` rebuild ‡¶ï‡¶∞‡¶æ ‡¶â‡¶ö‡¶ø‡¶§ ‡¶ï‡¶ø‡¶®‡¶æ‡•§

```dart
BlocBuilder<MyBloc, MyState>(
  condition: (previous, current) {
    // return true/false to determine whether to call builder
  },
  builder: (context, state) {...}
)
```

`condition` ‡¶®‡¶æ‡¶Æ‡¶ü‡¶ø ‡¶ñ‡ßÅ‡¶¨ self-explanatory ‡¶¨‡¶æ obvious ‡¶®‡¶Ø‡¶º ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶∞‡¶ì ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£,
`BlocConsumer`-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá interact ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º API inconsistent ‡¶π‡¶Ø‡¶º‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤ ‡¶ï‡¶æ‡¶∞‡¶£
‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶∞‡¶æ ‡¶¶‡ßÅ‡¶ü‡¶ø condition ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá (‡¶è‡¶ï‡¶ü‡¶ø `builder`-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ï‡¶ü‡¶ø
`listener`-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)‡•§ ‡¶´‡¶≤‡¶∏‡ßç‡¶¨‡¶∞‡ßÇ‡¶™, `BlocConsumer` API ‡¶è‡¶ï‡¶ü‡¶ø `buildWhen` ‡¶è‡¶¨‡¶Ç
`listenWhen` expose ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø‡¶≤

```dart
BlocConsumer<MyBloc, MyState>(
  listenWhen: (previous, current) {
    // return true/false to determine whether to call listener
  },
  listener: (context, state) {...},
  buildWhen: (previous, current) {
    // return true/false to determine whether to call builder
  },
  builder: (context, state) {...},
)
```

API align ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶∞‡¶ì consistent developer experience ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶§‡ßá,
`condition`-‡¶ï‡ßá `buildWhen` ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§

**v4.x.x**

```dart
BlocBuilder<MyBloc, MyState>(
  condition: (previous, current) {
    // return true/false to determine whether to call builder
  },
  builder: (context, state) {...}
)
```

**v5.0.0**

```dart
BlocBuilder<MyBloc, MyState>(
  buildWhen: (previous, current) {
    // return true/false to determine whether to call builder
  },
  builder: (context, state) {...}
)
```

#### ‚ùóBlocListener condition-‡¶ï‡ßá listenWhen ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£

##### Rationale

‡¶â‡¶™‡¶∞‡ßá ‡¶¨‡¶∞‡ßç‡¶£‡¶ø‡¶§ ‡¶è‡¶ï‡¶á ‡¶ï‡¶æ‡¶∞‡¶£‡ßá, `BlocListener` condition-‡¶ì ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§

**v4.x.x**

```dart
BlocListener<MyBloc, MyState>(
  condition: (previous, current) {
    // return true/false to determine whether to call listener
  },
  listener: (context, state) {...}
)
```

**v5.0.0**

```dart
BlocListener<MyBloc, MyState>(
  listenWhen: (previous, current) {
    // return true/false to determine whether to call listener
  },
  listener: (context, state) {...}
)
```

### `package:hydrated_bloc`

#### ‚ùóHydratedStorage ‡¶è‡¶¨‡¶Ç HydratedBlocStorage ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£

##### Rationale

[hydrated_bloc](https://pub.dev/packages/hydrated_bloc) ‡¶è‡¶¨‡¶Ç
[hydrated_cubit](https://pub.dev/packages/hydrated_cubit)-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá code reuse
‡¶â‡¶®‡ßç‡¶®‡¶§ ‡¶ï‡¶∞‡¶§‡ßá, concrete default storage implementation-‡¶ï‡ßá `HydratedBlocStorage`
‡¶•‡ßá‡¶ï‡ßá `HydratedStorage` ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶è‡¶õ‡¶æ‡¶°‡¶º‡¶æ‡¶ì, `HydratedStorage`
interface-‡¶ï‡ßá `HydratedStorage` ‡¶•‡ßá‡¶ï‡ßá `Storage` ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§

**v4.0.0**

```dart
class MyHydratedStorage implements HydratedStorage {
  ...
}
```

**v5.0.0**

```dart
class MyHydratedStorage implements Storage {
  ...
}
```

#### ‚ùóHydratedStorage-‡¶ï‡ßá BlocDelegate ‡¶•‡ßá‡¶ï‡ßá decouple ‡¶ï‡¶∞‡¶æ

##### Rationale

‡¶Ü‡¶ó‡ßá ‡¶â‡¶≤‡ßç‡¶≤‡¶ø‡¶ñ‡¶ø‡¶§, `BlocDelegate`-‡¶ï‡ßá `BlocObserver` ‡¶®‡¶æ‡¶Æ‡¶ï‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç set ‡¶ï‡¶∞‡¶æ
‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø `bloc`-‡¶è‡¶∞ ‡¶Ö‡¶Ç‡¶∂ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá:

```dart
Bloc.observer = MyBlocObserver();
```

‡¶®‡¶ø‡¶Æ‡ßç‡¶®‡¶≤‡¶ø‡¶ñ‡¶ø‡¶§ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá:

- ‡¶®‡¶§‡ßÅ‡¶® bloc observer API-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá consistent ‡¶•‡¶æ‡¶ï‡¶§‡ßá
- Storage-‡¶ï‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ `HydratedBloc`-‡¶è scoped ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá
- `BlocObserver`-‡¶ï‡ßá `Storage` ‡¶•‡ßá‡¶ï‡ßá decouple ‡¶ï‡¶∞‡¶§‡ßá

**v4.0.0**

```dart
BlocSupervisor.delegate = await HydratedBlocDelegate.build();
```

**v5.0.0**

```dart
HydratedBloc.storage = await HydratedStorage.build();
```

#### ‚ùóSimplified Initialization

##### Rationale

‡¶Ü‡¶ó‡ßá, ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ manually call ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶§
`super.initialState ?? DefaultInitialState()` ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ `HydratedBloc` instances
setup ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ‡¶è‡¶ü‡¶ø clunky ‡¶è‡¶¨‡¶Ç verbose ‡¶è‡¶¨‡¶Ç `bloc`-‡¶è `initialState`-‡¶è‡¶∞ breaking
changes-‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá‡¶ì incompatible‡•§ ‡¶´‡¶≤‡¶∏‡ßç‡¶¨‡¶∞‡ßÇ‡¶™, v5.0.0-‡¶è `HydratedBloc` initialization
normal `Bloc` initialization-‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á‡•§

**v4.0.0**

```dart
class CounterBloc extends HydratedBloc<CounterEvent, int> {
  @override
  int get initialState => super.initialState ?? 0;
}
```

**v5.0.0**

```dart
class CounterBloc extends HydratedBloc<CounterEvent, int> {
  CounterBloc() : super(0);

  ...
}
```
